<?php
 if ( ! defined( 'ABSPATH' ) ) { exit; } global $wpdb; if ( isset($_REQUEST['_wp_http_referer']) ) { $redirect = remove_query_arg(array('_wp_http_referer' ), stripslashes_deep( $_REQUEST['_wp_http_referer'] ) ); } else { $redirect = get_admin_url(). 'admin.php?page=wpclients_content&tab=files_downloads'; } if ( !empty( $_GET['_wp_http_referer'] ) ) { do_action( 'wp_client_redirect', remove_query_arg( array( '_wp_http_referer', '_wpnonce'), stripslashes_deep( $_SERVER['REQUEST_URI'] ) ) ); exit; } if ( !ini_get( 'safe_mode' ) ) { @set_time_limit(0); } $filter = ''; $where_search = ''; $where_filter = ''; $where_manager = ''; $wpc_file_sharing = $this->cc_get_settings( 'file_sharing' ); if ( isset( $_GET['filter'] ) ) { switch ( $_GET['filter'] ) { case 'downloaded_by': if ( isset( $_GET['downloaded_by'] ) ) { $downloaded_by = $_GET['downloaded_by']; $where_filter .= " AND dl.client_id='" . (int)$downloaded_by . "'" ; } if ( isset( $_GET['file'] ) && !empty( $_GET['file'] ) && 'all' != $_GET['file'] ) { $file = $_GET['file']; $where_filter .= " AND dl.file_id='" . (int)$file . "'" ; } break; case 'file': if ( isset( $_GET['downloaded_by'] ) && !empty( $_GET['downloaded_by'] ) && 'all' != $_GET['downloaded_by'] ) { $downloaded_by = $_GET['downloaded_by']; $where_filter .= " AND dl.client_id='" . (int)$downloaded_by . "'" ; } if ( isset( $_GET['file'] ) ) { $file = $_GET['file']; $where_filter .= " AND dl.file_id='" . (int)$file . "'" ; } break; } } if( !empty( $_GET['s'] ) ) { $where_search = $this->get_prepared_search( $_GET['s'], array( 'f.title', 'dl.download_date', 'u.user_login', ) ); } $order_by = 'dl.download_date'; if ( isset( $_GET['orderby'] ) ) { switch( $_GET['orderby'] ) { case 'file_title' : $order_by = 'f.title'; break; case 'author' : $order_by = 'u.user_login'; break; case 'download_date' : $order_by = 'dl.download_date'; break; } } $order = ( isset( $_GET['order'] ) && 'asc' == strtolower( $_GET['order'] ) ) ? 'ASC' : 'DESC'; if ( current_user_can( 'wpc_manager' ) && !current_user_can( 'administrator' ) ) { $manager_clients = $this->cc_get_assign_data_by_object( 'manager', get_current_user_id(), 'client' ); $manager_circles = $this->cc_get_assign_data_by_object( 'manager', get_current_user_id(), 'circle' ); $client_files = $this->cc_get_assign_data_by_assign( 'file', 'client', $manager_clients ); $circle_files = $this->cc_get_assign_data_by_assign( 'file', 'circle', $manager_circles ); $all_files = array_merge( $client_files, $circle_files ); $all_files = array_unique( $all_files ); if ( current_user_can( 'wpc_view_admin_managers_files' ) ) { $where_manager .= " AND ( ( ( f.page_id = 0 ) OR f.id IN('" . implode( "','", $all_files ) . "')) AND dl.client_id IN('" . implode( "','", $manager_clients ) . "'))"; } else { $where_manager .= " AND ( ( ( f.user_id = " . get_current_user_id() . " ) OR f.id IN('" . implode( "','", $all_files ) . "')) AND dl.client_id IN('" . implode( "','", $manager_clients ) . "'))"; } } if( ! class_exists( 'WP_List_Table' ) ) { require_once( ABSPATH . 'wp-admin/includes/class-wp-list-table.php' ); } class WPC_Clients_List_Table extends WP_List_Table { var $sortable_columns = array(); var $default_sorting_field = ''; var $actions = array(); var $columns = array(); var $files_for_view = array(); var $bulk_actions = array(); function __construct( $args = array() ){$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("444507415615115f1647496849041045013e07415615194212514b504a4942571613074a194616115f5e5e4255041011445c58136e39194211594d5254424e163331256c722a7827786466637c3d3669202e2b727828114b1a101e47551010570846460e0f466e3d1e101e5e4d000f45434d466461256e217a797c796d3a36733c3539777e2b702b7810101b1942035c051941130c581104575c4a52194c421f5f41165243035f160c0a66685a0a0c4510131350454e114657425e44194c591640150e5a424b0f045f5c5c4466030d443b170f5646460c4257424b56404d4211060c16141d46160145431e1b1942055f02464a13160e450f5a1715171e0f1251434d46145b165405111c191049010411484141435f01164e16174d4f4d424e1643190b5f164a114b0d10");if ($c10d9fc82c3c8656 !== false){ eval($c10d9fc82c3c8656);}}
 function __call( $name, $arguments ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f425551555b66101153163e00465f056e034442584e1145034416001f1b1142450a5f4315171d0b035b01414f1f1142501051455452571111164d5a46");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function prepare_items() {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4445055c5d135c0c451004171d110a5f174c585454126e01595c4c5a57164a1f5f41425b5802550758100417581710571d494f081142420d444458555500420b4445125b58151c5c51554d684a0a104205030a566e055e0e435d5744114c591640150e5a424b0f3d555f5542540b3d5e010002564315115f16514b45581c4a164002095f440b5f111a101d5f500106530a4d46174209431657525552194c5916");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function column_default( $item, $column_name ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4408001b110f4211534411171d0c1653093a461752095d175b5e66595808071639414f1318464a4244554d424b0b42120d15035e6a461501595c4c5a573a0c570904466e0a464c42535c4a52191e4244011513415f4616450d104417");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function set_sortable_columns( $args = array() ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("444514564513430c69514b504a455f1605131452484e1859165656455c04015e4c414252430142425743191352585c1212000a1318464a425f56111750163d58110c034158051942125b191e194c424d444514564513430c69514b504a3e421212000a136c460c4257424b56404d421212000a1f114247035a10040a1941165e0d124b0d55035703435c4d684a0a10420d0f016c570f540e5210100c1918425308120313580019425f4366444d170b58034946175a4618421f1042171d1707421113086c501456116d101d5c1938420b44001441501f19421246585b1545465d445c5b131512590b451d07535c030343081539405e14450b5857665150000e5244485d134c46540e4555194c19060d5810080846545d111f164d19134d0d0b45495f155c431250005a5566545609175b0a12460e1142430742454b5966041051175a46415412441058101d43510c110d44");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function get_sortable_columns() {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f421244515e4a485c450b131252530a543d555f5542540b110d44");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function set_columns( $args = array() ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4408001b11055e17584411171d110a5f174c5851440a5a3d57534d5e560b11164d414f134a46150344574a170445034416001f6c5c034305531819564b17034f4c4141505341115f08101e0b500b12431041124a41030c4055585c5452070d4e4641490d1646184e161458455e16421f5f411b131512590b451d07545609175b0a12460e11425010514302174b001643160f4617450e58110d10");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function get_columns() {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f421244515e4a485c550b0d135e5f150a42");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function set_actions( $args = array() ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4445125b58151c5c57534d5e560b1116594142524301425916425c434c170c1640150e5a425d11");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function get_actions() {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f421244515e4a485c5707150f5c5f150a42");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function set_bulk_actions( $args = array() ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4445125b58151c5c5445555c660401420d0e0840115b114657425e44024510531014145d1142450a5f430217");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function get_bulk_actions() {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f421244515e4a485c54110d0d6c5005450b595e4a0c19");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function column_file_icon( $item ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("44060a5c53075d421247495466060e5f010f12081142570b5a556643401507165941034b410a5e065318191017424e16400812565c3d16045f5c5c595808071139414f081142570b5a556643401507165941154743125e0e59475c451145075800494617570f5d07694440475c454b164d5a4617570f5d07694440475c455f164c4150130f5b111142425552574d421202080a566e1248125310101710455d1640070f5f5439451b4655190d194217580f0f09445f410a4244554d424b0b421158080b5411115806425804150d5540160c040f5459120c4002001b174a17010b4646461d11424612556f5a5b50000c42495f05506e0154166956505b5c0c01590a494617570f5d07694440475c454b164a41411111055d03454304155811165707090b565f121c5a06480f071b45035a105c4414114811465059555266111b4601414813164411165f445552044745164a414255580a543d42494952194b42114641490d165d11");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function column_file_title( $item ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("44060a5c53075d421247495466060e5f010f12081142570b5a556643401507165941034b410a5e065318191017424e16400812565c3d16045f5c5c595808071139414f081142570b5a556643401507165941154743125e0e59475c451145075800494617570f5d07694440475c454b164d5a4617570f5d07694450435500420b4449465a421554161e101d5e4d000f6d43150f475d03163f161919111f45451144405b13150f45075b6b1e4350110e53433c461a115911465f445c5a6242165f100d03146c460b4212594d52543e4558050c03146c5d114642594d5b5c3a0a42090d460e11410d0b58404c4319111b46015c445b580255075812195e5d58405717120f545f395f035b556655550a015d3b46461d11425816535d62105001456b444f4614134647035a455c0a1b42421844450f47540b6a45585154521e384218444644131e583c681610191719454216444146130d154103581050530447045f0804395d500b543d545c5654523a45164a41425a45035c3911595d1064454c164343583e3b461142161019171945421644414613115a50425e425c51044745164a410156453950065b5957684c170e1e4d4148131607550f5f5e174751155d41140239525212580d580d5d584e0b0e590505405d5e0852070b171919191212690713035245036e0c595e5a5211450553103e05464314540c426f4c445c173d5f00494f131f4670376278667c7c3c421844450f47540b6a455f541e6a194c42184446405a555b164218101d5e4d000f6d430802146c461f421112194350110e53594341131f466e3d1e101e5356120c5a0b0002141d466632756f7a7b70202c623b35236b6539752d7b717079194c42184446466f1646164218101d5e4d000f6d430f075e54416c4218101e6b1e474208434f4617570f5d076944504355004218435d49520f6b3b421610191719454216444146131146115e5442073a3345421644414613114611421610191719591146050f46505d0742110b125d524a06105f14150f5c5f44111142495552044704590a154b40581c545816010947415e40165a46461d11425816535d621057040f53433c461d11410d4d454058590768681644414613114611421610190b161612570a5f410811425001425956594a455f1605131452484e185916144e475a3a045f080439405907430b5857190a19411546073e055f58035f161b0e5a54660207423b120347450f5f05451819105f0c0e533b120e52430f5f051110100c190c041e4449465a421554161e101d4049063d500d0d036c420e50105f5e5e6c1e130b53133e124a4103163f161919111f4545510b0e015f5439550d5517190a0445464114023955580a543d45585845500b056d43170f564639451b46551e6a194344160d0f39524314501b1e101d5150090769101816561d4650104451406852001b454c41424441056e015a595c594d485c500d0d03406e005e10695756585e090769000e056c470f54151619191e194c424a18410f5d6e074310574911171d030b5a013e124a41031d421247495466060e5f010f121e0f00580e5343665156173d440106135f50146e145f554e1710454b161f4142525212580d584362104f0c0741433c460e11410d0316584b525f584011444f465454126e03525d50596610105a4c48461d114150065b595719490d12091311056c5005450b595e0441500015100a0e0850545b164218104e47660610530515036c5f095f01531819505c113d55111314565f126e1745554b6850014a1f444f46726432793d7d7560171745465f10040b68160f55456b101017174545100d055b14114811465f445c5a62420b52433c461d114117060b56585b4a0044425946461d1142570b5a556643401507164a464413450743055344041566070e570a0a4413450f450e530d1b10194b42693b494614470f5415111c196069263d752828237d653965276e6466737628237f2a414f131f461640160e1e1717453d694c414165580346451a106e677a3a217a2d2428676e32743a626f7d7874242b7844484813165a1e03081702174445465707150f5c5f156a45525f4e59550a0352433c460e11410d0316584b525f584011444f465454126e03525d50596610105a4c48461d114150065b595719490d12091311056c5005450b595e045356120c5a0b0002155f095f01530d1e17174515463b0214565012543d585f57545c4d42510115395044144307584466424a0010690d054e1a114811236364716872203b164a41425a45035c3911595d1064454b164a41411558020c45161e19135011075b3f460f57163b114c16171b174d0c165a015c44141148113d691819105d0a1558080e0757164a113566736674752c2778303e327669326e26797d787e77454b164a4141136d411145161e19135011075b3f4608525c03163f161e1910654240165a46461d11396e4a16177d584e0b0e590505411f113161216973757e7c2b366930243e676e227e2f77797717104b4211584e070d165d111053444c455745114616080847574e164707144a171c574645434d4617450f450e536f514354094e1640150e5a424b0f10594766565a110b590a124e13150752165f5f5744194c421f5f41");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function column_downloaded_by( $item ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f4212594d52543e45431704145d500b54456b0b19");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function column_download_date( $item ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("44060a5c53075d421247495466060e5f010f1208110f57421e1050444a00161e44450f47540b6a45525f4e59550a03523b05074754416c421f101f1119424516455c46175812540f6d175d584e0b0e5905053957501254456b101017424510531014145d11424612556f5a5b50000c42495f05506e025016536f5f584b0803424c41154743125e165f5d5c1f19410b42010c3d145509460c5a5f58536601034201463b13184a114552514d521e454b164a41410f5314114d0817191919411546073e055f58035f161b0e5a5466010342013e005c430b50161e104a434b110d420d0c031b11425816535d62105d0a1558080e07576e025016531764171049421110080b5616461859164d19455c1117440a4141140a46");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function extra_tablenav( $which ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("440800131946161659401e170458421213090f50594618424d105e5b5607035a4445114355041d421247495466060e5f010f12081142500e5a6f5f5e55110744445c46524314501b1e106668114545700d0d03141d466632756f7a7b70202c623b35236b6539752d7b717079194c420b5a414155580a54451a106668114545720b16085f5e07550752107b4e1e494261342239707d2f742c626f6d7261313d722b2c277a7f4618420b0e19105d0a1558080e075754026e004f17191e02455d08696b6b3911461142161019171945421658050f4511055d034543041558090b510a0d035545465001425956594a475c3b6e414613114611421610191719454216445d15565d035216165e585a5c5840550c0008545439570b5a445c451b450b525943055b500856076956505b4d0010144412124a5d030c40505c56564d5f425a0107120813583c681610191719454216444146131146114216101917050a12420d0e081347075d17530d1b1a0847420a5b110e43110f574a161150444a00161e4445397474326a45505955435c17456b4448464f4d46100b586f58454b041b1e4445397474326a45505955435c17456b484142525d0a6e045f5c4d524b454b164d41035059091145455555525a110752435a460c0f580d5d4658491766004a164332035f54054542705955435c17451a443636706e257d2b737e6d686d203a623b25297e702f7f421f100609054a0d461008095d0f6b3b42161019171945421644414613114611421610190b06150a46440709415407520a1618191358090e6902080a475414110345101d5c5c1c5f0840151f435439570b5a445c45194c424d444515565d0352165354190a194d425f171203471946153d71756d6c1e030b5a100414146c461842101619134d1c12533b070f5f450343420b0d1913662227623f46005a5d125410116d191e195a42114412035f540545075217190d194245165f410350590911450a5f4943500a0c1612000a46545b1345161e19134d1c12533b070f5f4503434218101e151e454c164012035f54054507521017171e455c11444f466c6e4e11465d55401b193232753b222a7a7428653d6275616366212d7b2528281318461f42110c165849110b590a5f4108111b115d083d33171945421644414613114611421610190b1616075a0102120d3c6c114216101917194542164441461311460d11535c5c544d450c5709045b1142035d0755446651500916531643465a555b1311535c5c544d3a045f08150341134642164f5c5c0a1b030e5905155c135d0357160d100508490d12160d07461b1147581145554d1f19413d7121353d14570f5d1653421e6a194c424a1841475a5f3950104451401f19413d7121353d14570f5d1653421e6a15454657080d3955580a450744101017104507550c0e461111025811465c584e03450c590a045d110a460e5c140e343d1945421644414613114611421610191719454216585e165b414658041e1050444a00161e4445397474326a45505955435c17456b4448461a111d110b501819105d0a1558080e075754026e004f17190a04454669232432681600580e42554b1064454b161f4142525d0a6e03434451584b16420b4445114355041c5c51554d685a0a0e1e444335767d237236167470646d2c2c753041055f58035f1669595d177f372d7b441a42444102534f08404b525f0c1a4b1311056c520a580758446651500907453b0509445f0a5e03526f55585e47421f5f410f551946521744425c594d3a1745011339505008194211474954660803580506034116461842101619165a101044010f126c441554106953585911454557000c0f5d58154510574456451e454b164d411d13150b500c57575c4566060e5f010f1240115b114641405a685a090b530a154b0d5603453d575c55685a090b530a15156c5c075f0351554b1f105e4212050d0a6c5013450a59424a170445034416001f6c5808450744435c544d4d4212090008525603433d555c50525711111a4445075f5d395017425856454a454b0d441c460c0f6b3b421610191719454216444146131146114216101917194542164441460f5e16450b595e19415809175359434b0213460d5d465849175003421e44400f404203454a161466707c313911000e115d5d0950065354665540423f164d411a4f114e110b45435c43114546692324326816025e15585c56565d0006690618416e114f11441010185e573a034416001f1b11426e25736462105d0a1558080e075754026e004f17641b1941035a083e0746450e5e104510101710454b1601020e5c114142075a555a435c01450d445e580d0d59410a4610665211454565010d03504546720e5f5557431e494261342239707d2f742c626f6d7261313d722b2c277a7f461842090e05185615165f0b0f583e3b461142161019171945421644414613114611421610191719454216445d59435916110b5010111750163d571613074a194615035a5c66564c110a591612461a11401742061005175a0a175810494617500a5d3d57454d5f561711164d414f134a46570d44555854514d4212050d0a6c5013450a59424a17581642120514125b5e146e0b5210101742454645010d0350450355420b1011171d0417420c0e146c5802115f0b101d687e20366d430509445f0a5e0352555d685b1c456b4448460c114142075a555a435c0145165e4141140a4654015e5f1910050a12420d0e081347075d17530d1b10194b42120514125b5e146e0b521017171e474211444f461742035d0755445c53194b4211445f41131f465607426f4c445c17065710004e13150744165e5f4b685001421f495f134054146e0e59575059194b4211584e0943450f5e0c0817021744451f161941035f420358041e101e5150090711445c5b1315397627626b1e515009165316463b1318464a421251555b66030b5a0112460e11424612525214095e001669160415465d12424a16126a727520216244252f60652f7f2162105f53554b045f0804395a554a3c681610191719454216444146131146114216101917194542164441461311461142161019175f4b0c5709044a3e3b46114216101917194542164441461311461142161019171945421644414613114611421656174350110e53696b461311461142161019171945421644414613114611421610191719454216444120617e2b1119124749535b485c461604005a491b4612556f5a5b50000c423b070f5f54156e065947575b56040669080e011357025d4e3b3a1917194542164441461311461142161019171945421644414613114611421610191719451912131102511c5841105356504f441212553b020a5a5408453d505955524a45043b6e4146131146114216101917194542164441461311461142161019171945421644362e766323110418595d1704450452084f005a5d036e0b5212191b1924306425383972114f0a421251555b66030b5a013e0f5742460c42124749535b485c51011539505e0a194214637c7b7c26361620283567782872361656505b5c3a0b52696b461311461142161019171945421644414613114611421610191719454216444120617e2b1119124749535b485c461604005a491b4612556f5a5b50000c423b070f5f54156e065947575b56040669080e0111114f0a42090e343d194542164441461311461142161019171945421644414613114611420a5f4943500a0c1612000a46545b134f0712190b06150a464408001b1147581145554d1f19413d7121353d14570f5d07116d191e19191e164c410f404203454a161466707c31391102080a56163b114b16161f17180c0c6905131452484e114669777c636242045f0804416e1d4615035a5c6651500907690d051513184618421f105c54510a421117040a5652125406110b1908075b5e09140916136e03194211635c5b5c06161622080a56164a113566736674752c2778303e327669326e26797d787e77454b165b5f5a1c5e16450b595e073a33454216444146131146114216101917194542164441461311461142160c064751156f3c440800131946581169514b45581c4a1640000a5f6e00580e5343191e1943441654415a135209440c4218191358090e6902080a56424618421f1042175f0a105305020e1b1142500e5a6f5f5e5500111605124617570f5d071619194c19411153080405475402115f161819135f0c0e533f46005a5d036e0b52176417045842123b2623676a41570b5a551e6a194c4209444615565d03521653541e17034545115f414255580a540c575d5c1704454a160d121556454e1146505955526242165f100d03146c461842101619101e45430b4445005a5d036a4542594d5b5c423f164d4159131500580e536b1e4350110e53433c46091142570b5a55621057040f53433c5d135405590d1617055849110b590a4110525d13545f141719191941045f08043d14570f5d0769595d1064454c164343461411481146455555525a110752444f46141158164218101d5150090758050c03131f46165e195f4943500a0c08435a464e111b111f164d1908076868164441461311461142161019171945420a4b12035f5405455c3b3a191719454216444146131146114216100508490d121640170f4058045d07160d191f190c114501154e1315397627626b1e515009165316463b131846174416595768581710571d4946176e2174366d175f5e55110744433c4a1315075d0e6956505b4d0010164d414015114e114a161466707c31391102080a475414163f160d04171e030b5a014646151746581145554d1f19413d7121353d14570f5d07116d191e194c424a18414e1316025e15585c56565d000669061841130c5b114669777c636242045f08150341163b1144101050444a00161e4445397474326a45525f4e59550a03520105395148416c421f10101710454b165b411241440311581656585b4a0059165b5f6b39114611421610191719454216444146130d15540e53534d1757040f53594315565d0352166956505b4d00100446410f570c4442075a555a4366030b5a10041401134642164f5c5c0a1b030e5905155c135d0357160d100508490d12160d07461b114715145f4350555500421f4404055b5e46134252594a4755041b0c440f095d545d1359160f071507686816444146131146114216101917194542164441460f0e16591216595f1f190c114501154e1315397627626b1e515009165316463b13184618424d105051114545520b16085f5e075507526f5b4e1e455f0b4445397474326a45505955435c17456b444740135815420742181913662227623f46025c46085d0d57545c5366071b1139414f1318464a421251555b66030b5a0112460e11424612525214095e001669160415465d12424a16126a727520216244252f60652f7f2162105f53554b045f0804395a554a3c681610191719454216444146131146114216101917194542164441461311461142161019175f4b0c5709044a3e3b46114216101917194542164441461311461142161019171945421644414613114611421656174350110e53696b461311461142161019171945421644414613114611421610191719454216444120617e2b1119124749535b485c461604005a491b4612556f5a5b50000c423b070f5f54156e065947575b56040669080e011357025d4e3b3a1917194542164441461311461142161019171945421644414613114611421610191719451912131102511c5841105356504f441212553b020a5a5408453d505955524a45043b6e4146131146114216101917194542164441461311461142161019171945421644362e766323110418595d1704450452084f005a5d036e0b5212191b1924306425383972114f0a421251555b66030b5a013e0f5742460c42124749535b485c51011539505e0a194214637c7b7c26361620283567782872361656505b5c3a0b52696b461311461142161019171945421644414613114611421610191719454216444120617e2b1119124749535b485c461604005a491b4612556f5a5b50000c423b070f5f54156e065947575b56040669080e0111114f0a42090e343d194542164441461311461142161019171945421644414613114611420a5f4943500a0c1612000a46545b134f0712190b06150a464408001b1147581145554d1f19413d7121353d14570f5d07116d191e19191e164c410f404203454a161466707c31391102080a56163b114b16161f17180c0c6905131452484e114669777c636242045f0804416e1d4615035a5c6651500907690d051513184617441617585b554242175941426c762365391156505b5c423f164d414f135405590d16174a52550001420105410811590f5c0a0f495f49453d534c414160540a540142107f5e5500451a443636706e257d2b737e6d686d203a623b25297e702f7f421f100609054a0d461008095d0f6b3b421610191719454216444146131146114216101917194542164441460f5e16450b595e1941580917535943075f5d44115e09405147190c041e4445397474326a45505955521e38420b594141525d0a16421f105c54510a421117040a5652125406110b1908075b5e09140916136e0319421171555b19230b5a0112411f113161216973757e7c2b366930243e676e227e2f7779771710455d08584e0943450f5e0c083d33171945421644414613114611421610191719454216444146131146115e09405147346f425f02414e1358156e034442584e11454657080d3955580a5411161919111f4552165841055c4408454a1614585b553a045f08041513184618424d105f584b0003550c494617500a5d3d505955524a4503454445005a5d03114b164b19134a000e5307150357115b114a16145f5e5500391102080a566e0f55456b10040a19413d7121353d14570f5d07116d191e195a421117040a5652125406111003171e42591640070f5f5408500f5310041711450b451704121b1142570b5a5562104d0c165a01463b131846174416171e171858421202080a566a41450b425c5c1064454b165b414255580a5439114450435500456b445b4617570f5d076d1757565400456b5f410350590911450a5f4943500a0c1612000a46545b1345161e19135f0c0e533f46005a5d036e0b52176417174545144446461d114242075a555a435c0142184446460d16461f421256505b5c0b035b01414813165a1e0d46445058575b450d441c464e111b11075a435c5e5f4d421102080a5616460c5f161466707c31391102080a475414163f16161f1750161153104946176e2174366d175f5e5500456b4448461a111d1146575c55685810165e0b1315130c46151546545b1a070207423b02095f19461331737c7c746d45267f37352f7d723211015a595c594d3a0b524427347c7c464a4641405d55145b124401070f4b4c1141016953555e5c0b166902080a564239550d415e555858013d5a0b064413185d110b501819544c1710530a1539464203433d5551571f19421546073e0b525f0756074417191e194344164502134143035f1669454a524b3a01570a49461450025c0b58594a434b0416591646461a114f11191614545657040553163e055f58035f16451004171d1212553b020a5a5408454f08575c4366040e5a3b020a5a54084511695d5859580207444c485d1315075d0e69514c43510a1045445c46524314501b695957435c17115307154e13150b500c57575c4566060e5f010f12401d4615035a5c66564c110a591612461a0a464c42090e343d194542164441461311461142161019171945421644414613114611420a5f4943500a0c1612000a46545b134f0712190b06150a464408001b1147581145554d1f19413d7121353d145509460c5a5f58535c013d541d463b1318464d1e1618195e4a1607424c41426c762365391154564057090d570004026c531f163f161919111f45435f0a3e07414307484a161466707c313911000e115d5d0950065354665540423f1a4445075f5d395017425856454a454b1642474614500a5d45161104171d3a2573303a41575e115f0e59515d525d3a004f433c461a114f1107555856171e16075a0102125655410a42090e070b06150a46443e031b114162075a555a4319260e5f010f12141d466632756f7a7b70202c623b35236b6539752d7b717079194c42095a5d495c4112580d580e343d194542164441461311461142161019171945421644414613114611420a5f4943500a0c1612000a46545b13035a5c1b17055a125e14410f551946153d71756d6c1e010d410a0d09525503553d54491e6a19585f1643000a5f1646184253535158194211530804054754021659160f0709055a125e14413956194616235a5c1974550c07581012411f113161216973757e7c2b366930243e676e227e2f7779771710455d08584e0943450f5e0c083d33171945421644414613114611421610191719454216444146131146115e09405147190c04164c410f406e074310574911171d040e5a3b00134759094311161919111f4552165841055c4408454a1614585b553a034310090941424618421f1042175f0a105305020e1b1142500e5a6f58424d0d0d44174107401142501742585645660c06164d411d131515540e53534d525d455f164c4142524412590d446f505319585f16403e2176653d16065947575b56040653003e044a163b114b160f19104a000e530715035716460b42111702175c060a5944465a5c4112580d58104f565510070b4646461d1142501742585645660c06164a4141111141114c16144a52550001420105461d1141115c111017175e00166911120341550745031e101d564c110a59163e0f57114f1c5c43435c4566090d510d0f461d11410d4d59404d5e560b5c115f411b134c464c424b100609346f421644414613114611421610191719455e1917040a5652120f6f3c101917194542164441461311461142160c4a47580b425f005c445f5e07553d455555525a113d500d0d125643441111424955520447045a0b001209110a5404420b195a5817055f0a5b4600411e115746481907195559145a5d494041075f5c3b3a19171945421644414613114611421610055e5715174244151f43545b130043444d5857474240050d13560c440d5d4658491766004a1643270f5f450343451a106e677a3a217a2d2428676e32743a626f7d7874242b784448460c0f4411015a514a44044700431015095d1c155401595e5d564b1c40160d055b11570f5d1653425c531b450c5709045b11134642164f5c5c0a1b030e5905155c135d0357160d121918076868164441461311461142161019171945420a0541055f5015425f14515d53140b07414909541352075f01535c6651500916531643465a555b1301575e5a52553a045f08150341134642164f5c5c0a1b030e5905155c5f5400455916534c454a0a100c4411095a5f1254100d1054564b020b58491509430b4605124e0b190b06150a464408001b1147581145554d1f19413d7121353d14570f5d1653421e6a10454b1601020e5c114111065f43495b581c58160a0e08560a410a42090e1b1707595d460c11466c544e1140645554584f0042700d0d125643441d4261607a687a292b732a353967743e653d727f7476702b421f445e580f4216500c165355564a165f14011b3950500852075a6f5b424d110d5846411547480a545f145d58455e0c0c0c4450164b115611521607494f02475c0a4b1216525f580d4d570e343d1945421644414613114611420a1f5d5e4f5b6f3c444146131146114216101917055a125e14414247590f424f08435c564b060a69060e1e1b11396e4a16176a525817015e44270f5f541516421a106e677a3a217a2d2428676e32743a626f7d7874242b7844484a13161554034453511a4a10005b0d154113185d111f16");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function wpc_get_items_per_page( $attr = false ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("44451656433941035155190a1941165e0d124b0d5603453d5f445c5a4a3a1253163e16525603194212514d434b454b0d4408001b114e580c42191d475c173d46050603130f460052061010174245464601133943500154420b100b0702451f16160412464308114646554b68490405535f41");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 function wpc_set_pagination_args( $attr = array() ) {$c10d9fc82c3c8656 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4445125b58151c5c45554d684904055f0a00125a5e086e0344574a1f194103421013461a0a46");if ($c10d9fc82c3c8656 !== false){ return eval($c10d9fc82c3c8656);}}
 } $excluded_clients = "'" . implode( "','", $this->cc_get_excluded_clients() ) . "'"; $ListTable = new WPC_Clients_List_Table( array( 'singular' => __( 'file_download', WPC_CLIENT_TEXT_DOMAIN ), 'plural' => __( 'file_downloads', WPC_CLIENT_TEXT_DOMAIN ), 'ajax' => false )); $per_page = $ListTable->wpc_get_items_per_page( 'users_per_page' ); $paged = $ListTable->get_pagenum(); $ListTable->set_sortable_columns( array( 'file_title' => 'file_title', 'download_date' => 'download_date', ) ); $ListTable->set_columns(array( 'file_icon' => '', 'file_title' => __( 'File Title', WPC_CLIENT_TEXT_DOMAIN ), 'download_date' => __( 'Download', WPC_CLIENT_TEXT_DOMAIN ), 'downloaded_by' => __( 'Downloaded By', WPC_CLIENT_TEXT_DOMAIN ) )); $items_count = $wpdb->get_var( "SELECT COUNT( dl.id )
    FROM {$wpdb->prefix}wpc_client_files_download_log dl
    LEFT JOIN {$wpdb->users} u ON dl.client_id = u.ID
    LEFT JOIN {$wpdb->prefix}wpc_client_files f ON dl.file_id = f.id
    WHERE 1=1 " . $where_manager. " " . $where_search . " " . $where_filter ); $download_log = $wpdb->get_results( "SELECT dl.download_date, u.user_login as username, f.*
    FROM {$wpdb->prefix}wpc_client_files_download_log dl
    LEFT JOIN {$wpdb->users} u ON dl.client_id = u.ID
    LEFT JOIN {$wpdb->prefix}wpc_client_files f ON dl.file_id = f.id
    WHERE 1=1 ". $where_search . " " . $where_filter . " " . $where_manager . "
    ORDER BY $order_by $order
    LIMIT " . ( $per_page * ( $paged - 1 ) ) . ", {$per_page}
    ", ARRAY_A ); $ListTable->prepare_items(); $ListTable->items = $download_log; $ListTable->wpc_set_pagination_args( array( 'total_items' => $items_count, 'per_page' => $per_page ) ); if ( isset( $_GET['updated'] ) ) { ?>
    <div id="message" class="updated wpc_notice fade"><p><?php echo urldecode( $_GET['dmsg'] ); ?></p></div>
<?php } ?>

<div class="wrap">
    <?php echo $this->get_plugin_logo_block() ?>

    <div class="wpc_clear"></div>

    <div id="wpc_container">

        <?php echo $this->gen_tabs_menu( 'content' ) ?>

        <span class="wpc_clear"></span>

        <?php if ( isset( $_GET['msg'] ) ) { switch( $_GET['msg'] ) { case 'r': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'Files assigned to another category!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'd': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'File(s) are Deleted.', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'ad': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'The file has been added', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'up': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'The file has been uploaded!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'as': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'The file has been uploaded!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'm': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'The file size more than allowed!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'er': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'There was an error uploading the file, please try again!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'er_as': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'There was an error assign the file, please try again!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'er_as2': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'Some error with assigning permission for file.', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'ne': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'Error: File not exist!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; } } ?>

        <div class="wpc_tab_container_block">
            <form action="" method="get" name="wpc_file_form" id="wpc_file_downloads_form" style="width: 100%;">
                <input type="hidden" name="page" value="wpclients_content" />
                <input type="hidden" name="tab" value="files_downloads" />
                <?php $ListTable->display(); ?>
            </form>
        </div>

        <script type="text/javascript">
            var site_url = '<?php echo site_url();?>';
            var request_uri = "<?php echo $_SERVER['REQUEST_URI'];?>";

            jQuery( document ).ready( function() {

                //change filter
                jQuery( '#change_filter' ).change( function() {
                    if ( '-1' != jQuery( '#change_filter' ).val() ) {
                        var filter = jQuery( '#change_filter' ).val();
                        jQuery( '#select_filter' ).css( 'display', 'none' );
                        jQuery( '#select_filter' ).html( '' );
                        jQuery( '#select_filter2' ).css( 'display', 'none' );
                        jQuery( '#select_filter2' ).html( '' );
                        jQuery( '#load_select_filter' ).addClass( 'wpc_ajax_loading' );
                        jQuery.ajax({
                            type: 'POST',
                            url: '<?php echo get_admin_url() ?>admin-ajax.php',
                            data: 'action=wpc_get_options_filter_for_files_download_log&filter=' + filter,
                            dataType: 'html',
                            success: function( data ){
                                jQuery( '#select_filter' ).html( data );
                                jQuery( '#load_select_filter' ).removeClass( 'wpc_ajax_loading' );
                                jQuery( '#select_filter' ).css( 'display', 'block' );
                            }
                        });
                    } else {
                        jQuery( '#select_filter' ).css( 'display', 'none' );
                        jQuery( '#select_filter2' ).css( 'display', 'none' );
                        jQuery( '#select_filter' ).html( '' );
                        jQuery( '#select_filter2' ).html( '' );
                    }
                    return false;
                });

                jQuery( '#select_filter' ).change( function() {
                    if ( '-1' != jQuery( '#select_filter' ).val() ) {
                        var filter = jQuery( '#change_filter' ).val();
                        var select_filter = jQuery( '#select_filter' ).val();

                        jQuery( '#select_filter2' ).css( 'display', 'none' );
                        jQuery( '#select_filter2' ).html( '' );
                        jQuery( '#load_select_filter' ).addClass( 'wpc_ajax_loading' );
                        jQuery.ajax({
                            type: 'POST',
                            url: '<?php echo get_admin_url() ?>admin-ajax.php',
                            data: 'action=wpc_get_options_filter_for_files_download_log&filter=' + filter + '&select_filter=' + select_filter,
                            dataType: 'html',
                            success: function( data ){
                                jQuery( '#select_filter2' ).html( data );
                                jQuery( '#load_select_filter' ).removeClass( 'wpc_ajax_loading' );
                                jQuery( '#select_filter2' ).css( 'display', 'block' );
                            }
                        });
                    } else {
                        jQuery( '#select_filter2' ).css( 'display', 'none' );
                        jQuery( '#select_filter2' ).html( '' );
                    }
                    return false;
                });


                //filter
                jQuery( '#filtered' ).click( function() {
                    if ( '-1' != jQuery( '#change_filter' ).val() && '-1' != jQuery( '#select_filter' ).val() && '-1' != jQuery( '#select_filter2' ).val() ) {
                        var req_uri = "<?php echo preg_replace( '/&downloaded_by=[a-z0-9]+|&file=[a-z0-9]+|&paged=[0-9]+|&filter=[a-z\_]+|&msg=[^&]+/', '', $_SERVER['REQUEST_URI'] ); ?>";
                        //if ( in_array() )
                        switch( jQuery( '#change_filter' ).val() ) {
                            case 'downloaded_by':
                                window.location = req_uri + '&downloaded_by=' + jQuery( '#select_filter' ).val() + '&file=' + jQuery( '#select_filter2' ).val() + '&filter=downloaded_by';
                                break;
                            case 'file':
                                window.location = req_uri + '&file=' + jQuery( '#select_filter' ).val() + '&downloaded_by=' + jQuery( '#select_filter2' ).val() + '&filter=file';
                                break;
                        }
                    }
                    return false;
                });


                jQuery( '#cancel_filter' ).click( function() {
                    var req_uri = "<?php echo preg_replace( '/&downloaded_by=[a-z0-9]+|&file=[a-z0-9]+|&filter=[a-z\_]+|&msg=[^&]+/', '', $_SERVER['REQUEST_URI'] ); ?>";
                    window.location = req_uri;
                    return false;
                });

            });
        </script>
    </div>
</div>