<?php
 if ( ! defined( 'ABSPATH' ) ) { exit; } if ( !current_user_can( 'wpc_admin' ) && !current_user_can( 'administrator' ) && !current_user_can( 'view_others_clientpages' ) && !current_user_can( 'edit_others_clientpages' ) ) { if ( current_user_can( 'read_hubpage' ) || current_user_can( 'edit_hubpage' ) ) $adress = 'admin.php?page=wpclients_content&tab=hub_pages'; else $adress = 'admin.php?page=wpclients_content&tab=files'; do_action( 'wp_client_redirect', get_admin_url() . $adress ); } global $wpdb; if ( isset($_REQUEST['_wp_http_referer']) ) { $redirect = remove_query_arg(array('_wp_http_referer' ), wp_unslash( $_REQUEST['_wp_http_referer'] ) ); } else { $redirect = get_admin_url(). 'admin.php?page=wpclients_content'; } if ( isset( $_GET['action'] ) ) { switch ( $_GET['action'] ) { case 'trash': $pp_ids = array(); if ( isset( $_REQUEST['id'] ) ) { check_admin_referer( 'wpc_portal_page_trash' . $_REQUEST['id'] . get_current_user_id() ); $pp_ids = (array) $_REQUEST['id']; } elseif( isset( $_REQUEST['item'] ) ) { check_admin_referer( 'bulk-' . sanitize_key( $this->custom_titles['portal_page']['p'] ) ); $pp_ids = $_REQUEST['item']; } if ( count( $pp_ids ) ) { foreach ( $pp_ids as $pp_id ) { $type = $wpdb->get_var( $wpdb->prepare( "SELECT post_status FROM {$wpdb->posts} WHERE ID = '%d'", $pp_id ) ); if( $type ) add_post_meta( $pp_id, 'wpc_hubpage_old_status', $type ) ; $wpdb->update( $wpdb->posts , array( 'post_status' => 'trash' ), array( 'ID' => $pp_id ) ); } do_action( 'wp_client_redirect', add_query_arg( 'trashed', count( $pp_ids ), $redirect ) ); exit; } do_action( 'wp_client_redirect', $redirect ); exit; break; case 'untrash': $pp_ids = array(); if ( isset( $_REQUEST['id'] ) ) { check_admin_referer( 'wpc_portal_page_untrash' . $_REQUEST['id'] . get_current_user_id() ); $pp_ids = (array) $_REQUEST['id']; } elseif( isset( $_REQUEST['item'] ) ) { check_admin_referer( 'bulk-' . sanitize_key( $this->custom_titles['portal_page']['p'] ) ); $pp_ids = $_REQUEST['item']; } if ( count( $pp_ids ) ) { foreach ( $pp_ids as $pp_id ) { $new_status = get_post_meta( $pp_id, 'wpc_hubpage_old_status', true ) ; $wpdb->update( $wpdb->posts , array( 'post_status' => $new_status ), array( 'ID' => $pp_id ) ); } do_action( 'wp_client_redirect', add_query_arg( 'untrashed', count( $pp_ids ), $redirect ) ); exit; } do_action( 'wp_client_redirect', $redirect ); exit; break; case 'delete': $pp_ids = array(); if ( isset( $_REQUEST['id'] ) ) { check_admin_referer( 'wpc_portal_page_delete' . $_REQUEST['id'] . get_current_user_id() ); $pp_ids = (array) $_REQUEST['id']; } elseif( isset( $_REQUEST['item'] ) ) { check_admin_referer( 'bulk-' . sanitize_key( $this->custom_titles['portal_page']['p'] ) ); $pp_ids = $_REQUEST['item']; } if ( count( $pp_ids ) ) { foreach ( $pp_ids as $pp_id ) { $user_id = $wpdb->delete( $wpdb->usermeta, array( 'meta_key' => 'wpc_cl_hubpage_id', 'meta_value' => $pp_id ) ) ; wp_delete_post( $pp_id ); $this->cc_delete_all_object_assigns( 'portal_page', $pp_id ); } do_action( 'wp_client_redirect', add_query_arg( 'deleted', count( $pp_ids ), $redirect ) ); exit; } do_action( 'wp_client_redirect', $redirect ); exit; break; } } if ( !empty( $_GET['_wp_http_referer'] ) ) { do_action( 'wp_client_redirect', remove_query_arg( array( '_wp_http_referer', '_wpnonce'), wp_unslash( $_SERVER['REQUEST_URI'] ) ) ); exit; } $visible_status = array( 'trash', 'publish', 'future', 'draft', 'pending', 'private' ); $where_status = ''; if( !empty( $_GET['filter_status'] ) && in_array( $_GET['filter_status'], $visible_status ) ) { $where_status = " AND p.post_status = '" . esc_sql( $_GET['filter_status'] ) . "'"; } else { $for_all_visible_status = $visible_status; array_shift( $for_all_visible_status ); $where_status = " AND p.post_status IN ('" . implode( "','", $for_all_visible_status ) . "') "; } $where_clause = ''; if( !empty( $_GET['s'] ) ) { $where_clause = $this->get_prepared_search( $_GET['s'], array( 'p.post_title', ) ); } if( !empty( $_GET['tag'] ) ) { $post_ids = get_objects_in_term( $_GET['tag'], 'wpc_tags' ); if( is_array( $post_ids ) && count( $post_ids ) ) { $where_clause .= " AND p.ID IN (" . implode( ', ', $post_ids ) . ")"; } else { $where_clause .= " AND 0 = 1"; } } $where_manager = ''; if( current_user_can( 'wpc_manager' ) && !current_user_can( 'administrator' ) ) { $manager_id = get_current_user_id(); $manager_clients = $this->cc_get_assign_data_by_object( 'manager', $manager_id, 'client' ); $manager_groups = $this->cc_get_assign_data_by_object( 'manager', $manager_id, 'circle' ); $clients_groups = array(); foreach ( $manager_groups as $group_id ) { $clients_groups = array_merge( $clients_groups, $this->cc_get_group_clients_id( $group_id ) ); } $manager_all_clients = array_unique( array_merge( $manager_clients, $clients_groups ) ); $groups_clients = array(); foreach ( $manager_clients as $client_id ) { $groups_clients = array_merge( $groups_clients, $this->cc_get_client_groups_id( $client_id ) ); } $manager_all_groups = array_unique( array_merge( $manager_groups, $groups_clients ) ); $post_of_clients = $this->cc_get_assign_data_by_assign( 'portal_page', 'client', $manager_all_clients ); $post_of_groups = $this->cc_get_assign_data_by_assign( 'portal_page', 'circle', $manager_all_groups ); $cat_of_clients = $this->cc_get_assign_data_by_assign( 'portal_page_category', 'client', $manager_all_clients ); $cat_of_groups = $this->cc_get_assign_data_by_assign( 'portal_page_category', 'circle', $manager_all_groups ); $all_cats = array_unique( array_merge( $cat_of_clients, $cat_of_groups ) ); $posts_of_cats = $wpdb->get_col( "SELECT p.ID FROM {$wpdb->posts} p INNER JOIN {$wpdb->postmeta} pm ON ( p.ID = pm.post_id AND pm.meta_key = '_wpc_category_id' AND pm.meta_value IN ('" . implode( "','", $all_cats ) . "') ) WHERE p.post_type = 'clientspage'" ); $manager_all_post = array_unique( array_merge( $post_of_clients, $post_of_groups, $posts_of_cats ) ); $where_manager = " AND ( p.ID IN ('" . implode( "','", $manager_all_post ) . "') OR p.post_author = '" . get_current_user_id() . "' )" ; unset( $manager_clients, $manager_all_clients, $manager_groups, $manager_all_groups, $clients_groups, $groups_clients, $post_of_clients, $post_of_groups, $cat_of_clients, $cat_of_groups, $all_cats, $posts_of_cats, $manager_all_post ); } $where_cat = ''; if( isset( $_GET['wpc_pp_category'] ) && (int)$_GET['wpc_pp_category'] ) { $search_text = (int)$_GET['wpc_pp_category']; $where_cat = " AND cppc.cat_id = '" . $search_text . "'"; } $where_date = ''; $m = ( isset( $_GET['m'] ) ) ? (int)$_GET['m'] : 0 ; if ( 0 < $m && 6 == strlen( $m ) ) { $year = substr( $m, 0, 4 ); $month = substr( $m, 4, 6 ); $next_month = (int) $month + 1; $where_date = " AND p.post_modified > '{$year}-{$month}-01 00:00:00' AND p.post_modified < '{$year}-{$next_month}-01 00:00:00'"; } $order_by = 'p.ID'; if ( isset( $_GET['orderby'] ) ) { switch( $_GET['orderby'] ) { case 'date' : $order_by = 'p.post_modified'; break; } } $order = ( isset( $_GET['order'] ) && 'asc' == strtolower( $_GET['order'] ) ) ? 'ASC' : 'DESC'; if( ! class_exists( 'WP_List_Table' ) ) { require_once( ABSPATH . 'wp-admin/includes/class-wp-list-table.php' ); } class WPC_Portalpages_List_Table extends WP_List_Table { var $no_items_message = ''; var $sortable_columns = array(); var $default_sorting_field = ''; var $actions = array(); var $bulk_actions = array(); var $columns = array(); function __construct( $args = array() ){$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("444507415615115f1647496849041045013e07415615194212514b504a4942571613074a194616115f5e5e4255041011445c58136e39194211594d5254424e163331256c722a7827786466637c3d3669202e2b727828114b1a101e47551010570846460e0f466e3d1e101e5e4d000f45434d466461256e217a797c796d3a36733c3539777e2b702b7810101b1942035c051941130c581104575c4a52194c421f5f414247590f424f085e56685011075b173e0b5642155005531004171d041051173a41435d1343035a17641717454516434148136e391942115e564319030d430a0548141d466632756f7a7b70202c623b35236b6539752d7b717079194c5916140014565f120b58696f5a58571616441102121b114250105143191e0245");if ($cffbf368e5f05610 !== false){ eval($cffbf368e5f05610);}}
 function __call( $name, $arguments ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f425551555b66101153163e00465f056e034442584e1145034416001f1b1142450a5f4315171d0b035b01414f1f1142501051455452571111164d5a46");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function prepare_items() {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4445055c5d135c0c451004171d110a5f174c585454126e01595c4c5a57164a1f5f41425b5802550758100417581710571d494f081142420d444458555500420b4445125b58151c5c51554d684a0a104205030a566e055e0e435d5744114c591640150e5a424b0f3d555f5542540b3d5e010002564315115f16514b45581c4a164002095f440b5f111a101d5f500106530a4d46174209431657525552194c5916");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function column_default( $item, $column_name ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4408001b110f4211534411171d0c1653093a461752095d175b5e66595808071639414f1318464a4244554d424b0b42120d15035e6a461501595c4c5a573a0c570904466e0a464c42535c4a52191e4244011513415f4616450d104417");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function no_items() {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("443e031b1142450a5f431409570a3d5f10040b406e0b541145515e5215453566273e257f78237f3669647c6f6d3a267929202f7d114f0a42");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function set_sortable_columns( $args = array() ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("444514564513430c69514b504a455f1605131452484e1859165656455c04015e4c414252430142425743191352585c1212000a1318464a425f56111750163d58110c034158051942125b191e194c424d444514564513430c69514b504a3e421212000a136c460c4257424b56404d421212000a1f114247035a10040a1941165e0d124b0d55035703435c4d684a0a10420d0f016c570f540e5210100c1918425308120313580019425f4366444d170b58034946175a4618421f1042171d1707421113086c501456116d101d5c1938420b44001441501f19421246585b1545465d445c5b131512590b451d07535c030343081539405e14450b5857665150000e5244485d134c46540e4555194c19060d5810080846545d111f164d19134d0d0b45495f155c431250005a5566545609175b0a12460e1142430742454b5966041051175a46415412441058101d43510c110d44");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function get_sortable_columns() {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f421244515e4a485c450b131252530a543d555f5542540b110d44");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function set_columns( $args = array() ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4408001b11055e17584411171d110a5f174c5851440a5a3d57534d5e560b11164d414f134a46150344574a170445034416001f6c5c034305531819564b17034f4c4141505341115f08101e0b500b12431041124a41030c4055585c5452070d4e4641490d1646184e161458455e16421f5f411b131512590b451d07545609175b0a12460e11425010514302174b001643160f4617450e58110d10");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function get_columns() {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f421244515e4a485c550b0d135e5f150a42");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function set_actions( $args = array() ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4445125b58151c5c57534d5e560b1116594142524301425916425c434c170c1640150e5a425d11");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function get_actions() {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f421244515e4a485c5707150f5c5f150a42");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function set_bulk_actions( $args = array() ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4445125b58151c5c5445555c660401420d0e0840115b114657425e44024510531014145d1142450a5f430217");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function get_bulk_actions() {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f421244515e4a485c54110d0d6c5005450b595e4a0c19");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function column_cb( $item ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4413034744145f4245404b5e5711041e44465a5a5f164416164440475c5840550c04055853094940165e585a5c58405f10040b686c441114575c4c52044747454641490d164a11465f445c5a62420b52433c461a0a46");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function column_title( $item ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("44060a5c53075d421247495466060e5f010f120811425001425956594a455f1605131452484e185916595f1711450b451704121b11426e25736462105f0c0e42011339404507451745176417104544104446124150155945160d04171d3a2573303a4155580a4507446f4a4358111745433c461a111d110b501011175a101044010f126c4415541069535859114545530008126c5e12590744436654550c075810110754541516421f1010174245465707150f5c5f156a45435e4d4558160a1139415b13165a50425e425c51044703520908081d410e415d46515e52041212550808035d45156e01595e4d525711445707150f5c5f5b440c4242584451430b525946461d11425816535d62105001456b444f461417394612585f57545c5845164a4111436e05430757445c68570a0c55014946144616523d465f4b4358093d460506036c4408451057435110194b42120d15035e6a415806116d1919190207423b02134143035f1669454a524b3a0b524c48461a11481145106f4e47660d1642143e145657034307440d1e1717451744080408505e02544a164749684c0b115a05120e1b11426e3173626f726b3e45642130337662326e3764791e6a194c421f444f46141346450b425c5c0a1b424218440415506e07451644181968664d4211360415475e14544242585044190c1653094100415e0b11165e5519634b04115e434d466461256e217a797c796d3a36733c3539777e2b702b7810101710454c16434346130f41114c166f661f194230531715094154411d4261607a687a292b732a353967743e653d727f7476702b421f444f46140d49505c110b19135806165f0b0f15681602540e53445c1064455f16435d0713591454040b125853540c0c181409160c410756070b474954550c0758101239505e08450758441f565a110b590a5c02565d03450710595d0a1e454c16400812565c3d160b52176417174545103b16165d5e0852070b171919191212690713035245036e0c595e5a5211454541140239435e1445035a6f49565e003d52010d03475441114c161450435c0839110d05416e11481105534466544c1710530a1539464203433d5f54111e194c42184446406c46166e0a424449684b0004531604140e16461f424342555257060d52014946444139440c455c5844514d42123b3223616723633911627c666c2031623b34347a163b114b16191919194240161008125f545b1345161e19524a063d571015141b11396e4a16177d525500165344150e5a42465816535d19475c170f570a0408475d1f164e1667697466262e7f212f326c652369366974767a782c2c164d414f131f461640160e1e1717453d694c414177540a5416531069524b080358010f125f48411d4261607a687a292b732a353967743e653d727f7476702b421f444f46140d49505c110b194a19184253081203134a465804161819544c1710530a1539464203433d5551571f194207520d15395c450e5410456f5a5b50000c42140001564241114b1619194c194103551008095d423d160752594d1064455f16435d0713591454040b1249584a114c460c1159435e15455f111017171d0c1653093a415a55416c4218101e115806165f0b0f5b56550f45401644504355005f14434148135415523d57444d4511453d694c414176550f454242585044190c16530946461a114f114c16171b091e454c163b3e4e131623550b421715176e352169272d2f767f326e3673686d687d2a2f772d2f461a114811450a1f58091e5e42120502125a5e08423911545c5b5c11071139415b13165a50425e425c51044703520908081d410e415d46515e52041212550808035d45156e01595e4d525711445707150f5c5f5b45105743511150015f11444f46175812540f6d1750531e3842184446406c46165f0d58535c0a1e454c161311395043035016536f57585706071e444611435239410d4444585b66150351013e124150155945161e19135011075b3f460f57163b114c16575c4366061744160408476e134207446f5053114c421f444f46141739461269584d43493a105302041456435b164218104c4555000c550b05031b1111413d435e4a5b58160a1e4445396074346727646b1e657c34377337353966632f163f1619191e194b42114641125a450a545f14171919190011553b001247434e113d69181910740a145344150e5a42465816535d19435645165e01413241501559451a106e677a3a217a2d2428676e32743a626f7d7874242b784448461a11481145141019091e454c163b3e4e131632430345581e1b193232753b222a7a7428653d6275616366212d7b2528281318461f42110c16560742591619410f551946521744425c594d3a1745011339505008194541405a6858010f5f0a3e134054146e0e595750591e4c421f441a4617420559075b51190a190c116917120a1b18460e4211584d43491658194b4646091141591642400318164259164002134143035f1669454b5b1958421217020e565c07114c161466647c373473363a417b6532613d7e7f6a631e3842184445396074346727646b1e657c34377337353966632f163f0d101d47493a124401170f56463944105a1004175e00166905050b5a5f3944105a1819594c090e1a4300025e58081f125e40064049063d5707150f5c5f5b43075a5f5e5e574312570304395d500b545f465f4b4358093d46050603154107560769595d0a1e454c16400812565c3d160b5217641717454510160400564303433d4342550a1e454c1611130a565f055e06531819135a101044010f126c44145d421f10100c19184253081203134a461512466f49455c130b53133e13415d460c4251554d684900105b050d0f5d5a4e11465f445c5a62420b52433c461a0a464c4212515a43500a0c453f46105a5411163f160d19100504425e1604000e13411f4212404968491707400d04116c44145d4218171b17560b015a0d020d0e6d41430742454b5919060d580208145e1944164218104a474b0c0c420249466c6e4e11406f5f4c174e0c0e5a4403031343031c0e59575e525d480b5844140857541411165e551945560907160b0746164246450d16404b524f0c074144150e5a42464103515517177a0a0c420d0f13560e441d4261607a687a292b732a353967743e653d727f7476702b421f4841424441056e015a595c594d485c551112125c5c39450b425c5c446242015a0d040847163b6a454517641710454c1643434f086d41115c11101717663a4a1643311456470f5415111c196069263d752828237d653965276e6466737628237f2a414f131f46165e1951071002451f161604124643081111464250594d034a114150424011430346451715171e5900085800465b4303575f144056444d4b125e145e165c42120c45161e19135011075b3f460f57163b114c16171f565a110b590a5c03575812135c1110171711454a16434646120c46150b4255546c1e110b420804416e114f115d161450435c0839111008125f54416c420c101e1f1e454c163b3e4e1316085e4242594d5b5c424e163331256c722a7827786466637c3d3669202e2b727828114b161e19101042421f444f46140d49505c0a1f5b091e49421210090f401c58430d416f58544d0c0d58174946175005450b595e4a1710454b0d44");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function extra_tablenav( $which ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("440800131946161659401e170458421213090f50594618424d105e5b5607035a444511435239520e5f55574302455d08696b4613114611421610191719455e520d1746505d0742110b12585b50020c5a010712135005450b595e4a15076868164441461311461142161019171945420a5b110e431142450a5f431409540a0c420c123957430941065947571f1942015a0d040847421650055317191e02454655051503545e145807451004171d1212553b020a5a5408454f08515a54660207423b020a5a5408451146515e5266060342010609415803424a1f0b19515617075707094e13150550165357564550001116051246175a03485f08145a564d0005591618461a111d114657425e44195842571613074a1946160f5344586852001b11445c581316394612556f5a564d0005591618395a55411d42115d5c43583a145708140314115b0f42125358435c020d441d3a415a55416c4e161749584a113d421d110314115b0f421153555e5c0b16451400015616461859161449584a111116594101564539410d45444a1f194103440312461a0a4658041e1011175a101044010f126c441554106953585911454557000c0f5d58154510574456451e454b16181d465044144307584466424a0010690700081b11414612556f5853540c0c114448461a114017421718195e4a1607424c4142435e154511161919111f4543530911124a1946151259434d44194c421f4448464811135f11534411171d0603420106094158034239125b5c4e64454b0d4402095d450f5f17530b194a190c04164c4105464314540c426f4c445c173d55050f4e1316114101695d58595802074443414f131740114355454b455c0b1669111203416e05500c1e101e565d080b580d12124150125e10111010171045191640170f4058045d07695d584552001016594100525d15545916145a5b50000c423b080240115b114641405a685a090b530a154b0d5603453d575c55685a090b530a15156c5c075f0351554b1f105e42500b130352520e1942124056444d16425717414258541f0c5c124056444d454b161f41425050125405594240685001420b444505524503560d444962105001456b5f41424642034311695358435c020d441d415b131946581145554d1f194101571004015c431f6e0b5210101710455d16401616506e055d0b535e4d1a070601690304126c5015420b515e6653581103690618395c530c540142181910490a1042050d39435001543d55514d525e0a104f434d461752074507515f4b4e660c061a4446055f58035f16111010170345034416001f1b185d114643435c45660c0645445c46174616523d555c505257114f080702395454126e0345435050573a06571000395148395e005c555a43114545460b1312525d39410351551e1b1941125917154b0d78221d421153555e5c0b161144485d1315134207446f50534a455f160513145248395c0744575c1f194117450113156c52074507515f4b4e154546431704146c580242421f0b19135e170d4314123950501254055942401704454a160d121556454e114655514d525e0a104f3b0802131846184209101d4049063d550808035d454b0f01556f5e524d3a03451708015d6e025016576f5b4e660a005c0102121b1141410d4444585b66150351013e05524503560d44491e1b194101571004015c431f6e0b521c19105a0c10550804411318460b4257424b56404d4b0d444501415e13411169595d1704454641140239505d0f540c421d07545a3a0553103e0740420f560c69545843583a004f3b0e04595405454a161749584b11035a3b11075454411d42124056444d485c7f204d4614520f43015a551e17105e42120313094641156e0b52100417581710571d3e0b564301544a16145e45561012453b02074754015e104f1c19135e170d431412395a5546185916595f1711450b453b001441501f194212574b584c1511690d05461a11401742061005175a0a17581049461756145e174643665e5d454b164d41005c430350015e1819135e170d431412395a5546501116145e45561012690d05461a111d114643435c45660c0645445c46524314501b695d5c455e004a164014155643395806451c19134e150169070d0f565f121c5c555366505c113d51160e13436e055d0b535e4d44660c061e444501415e13413d5f54191e194c591619410f55114e110b456f58454b041b1e4445134054146e0b5243191e1943441654415a135209440c421819134c1607443b080240114f114b16144c445c173d5f0012460e1107431057496642570c1343014946174415541069595d44194c59160d07461b110f423d57424b56404d4212070d0f565f126e0b5243191e1943441654415a135209440c421819135a090b530a15395a5515114b1619194c19030d440100055b194615015a595c594d3a0b52174107401142520e5f555743660c06164d411d135800114a16595768581710571d494617520a58075844665e5d494212111203416e0f55111619191e191e42121208155a530a543d5b514b5c5c17420b44151446545d111f164d194a190c041e44404245581558005a55665a5817095316414f134a46440c45554d1f1941125917151568150d541b6b10100c19060d5810080846545d111f16144f5e4a0c005a013e0b52430d5410160d1951580911535f411b13580019421718195e4a1607424c4142435e154511161919111f4543530911124a1946151259434d44194c421f4448464811135f11534411171d0603420106094158034239125b5c4e64454b0d4402095d450f5f17530b194a1918424b444512525615115f16575c436611074409124e144616523d42515e441e4942110c0802566e035c12424904071e4c59165b5f6b393c6c114216101917194542164441461311460d11535c5c544d450c5709045b114616523d46406654581107510b131f110f6b3b42161019171945421644414613114611421610190b5615165f0b0f4645500a44070b121b09055a125e14413956194616345f554e1758090e16070012565609430b5343191015453566273e257f78237f3669647c6f6d3a267929202f7d114f0a42090e05185615165f0b0f583e3b46114216101917194542164441461311461142160c064751154212071414415408453d4010041750161153104946176e2174366d174e475a3a12463b02074754015e104f17641710455d16403e2176653d161546536647493a01571004015c431f163f160a19101e5e42500b130352520e1942125358435c020d440d0415135015114655514d525e0a104f4448464811590f6f3c101917194542164441461311461142161019171945421644414613115a5e12425956591913035a11045b110d59410a46105c54510a4212070012565609431b6d1750531e3842095a43460f0e16591216595f1f194101431613035d453947420b0d19135a041653030e144a6a415806116d191e191e42095a4115565d035216535404154a000e5307150357135a0e125e40194a195a5c08585e165b414654015e5f19135a041653030e144a6a415f035b551e6a195a5c0a4b0e164758095f5c111c343d1945421644414613114611421610191719454216444146130d59410a46104417065b6f3c44414613114611421610191719454216584e15565d035216083d33171945421644414613114611421610190b4a000e530715465d500b545f144458501b5b6f3c44414613114611421610191719454216444146130d0941165f5f57174f040e43015c44110f5a0e125e4019685c4d42113208034411075d0e164458504a424e163331256c722a7827786466637c3d3669202e2b727828114b0d100609054a0d461008095d0f6b3b42161019171945421644414613114611421610190b06150a46444505464314540c4210041750161153104946176e2174366d174d565e423f164d41591315397627626b1e435802456b445b4614165d110459425c565a0d4a16401507544246501116144d565e454b161f41590d3c6c114216101917194542164441461311461142161019171945421644415a5c4112580d58104f565510070b465d594359161107555856171d110351495f1256430b6e0b520b19080747420a5b110e431115540e53534d525d4d4212071414415408454e16144d565e485c4201130b6c5802114b0d10060907595d460c114656520e5e4212445850145b0c5709045d130e580d4d59404d5e560b5c11486c6c1311461142161019171945421644414613114611421610190b06150a46441c460c0f6b3b421610191719454216444146131146115e19435c5b5c061608696b461311461142161019171945421644415a0c410e414245455b5a50113d541115125c5f4e113d691819107f0c0e4201134113184a114554454d43560b451a4446005a5d12541069515a43500a0c11484100525d15544e16514b45581c4a1643080214115b0f42114056444d48134301131f1e4213530f5f441e1710454b0d445e583e3b4611421610191719454216445d495758100f6f3c10191719454216445d59435916111f16");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function column_clients( $item ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("44060a5c53075d421247495466060e5f010f12081142441153424a1704454641140239505d0f540c421d07545a3a0553103e0740420f560c69545843583a004f3b0e04595405454a161749584b11035a3b11075454411d4212594d52543e455f00463b1f1141520e5f5557431e454b0d440800131946521744425c594d3a1745011339505008194211474954660803580506034116461842101619165a101044010f126c441554106953585911454557000c0f5d58154510574456451e454b164d411d1315055d0b535e4d44195842121311056c520a5807584414095e001669050d0a6c520a580758444a6854040c570304141b185d11465b5557525d0207443b1415564315115f16514b45581c4a1f5f41005c430350015e1011171d10115316124652424615015a595c594d3a0b5244484648110f57421e100917054546550808035d453958061619194c190c04164c41475a421554161e101d54550c07581012461a111a4d4217595768581710571d494617520a58075844665e5d494212070d0f565f1242421f1010175a0a0c420d0f13560a4658041e1018525415164f4c4142505d0f540c426f5053194c421f441a46175c035f0752575c456610115316123d6e115b1146555c505257113d5f005a464e111b111f16144c445c1711165941425e5408540651554b684c160744175a464e1103520a59101e0b5d0c1416070d0740425b13115542565b553a06571000440d165d11465a59575c660410440518460e11074310574911171e010342054c0f5716460c5c161450435c0839110d05416e1d4616065744581a580f034e43415b0d11571d421144504355004516595f46404114580c42561117663a4a164320154058015f421343194356424e163331256c722a7827786466637c3d3669202e2b727828114b1a101d4049063d550808035d454b0f0143434d58543a165f100d03406a41520e5f5557431e38391114463b131846185916145059491016690513145248460c4257424b56404d42110a000b5616460c5c16174e475a3a015a0d040847423950085748626a1e4942110d0541130c58114541405a685a090b530a15156c16461f4212594d52543e455f00463b1f114147035a455c1019585c160d0c165f5e02544a161715101545464317041440114f114b0d101d565d010b420d0e08525d395010445140170445034416001f1b1141520d435e4d524b3a145708140314115b0f42555f4c594d4d421211120341424618421f0b19134e150169070d0f565f121c5c57535a685816115f030f39435e1644121e101e54550c075810464a13161141015a595c594d163d550808035d4539410351554a101545465a0d0f0d6c501443034f1c1913500b1243103e07414307484e161458535d0c165f0b0f075f6e0743105749191e024507550c0e46140d49550b400e1e0c19");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function column_groups( $item ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("44060a5c53075d421247495466060e5f010f12081103520a59101e0b5d0c1416070d0740425b13115542565b553a06571000440d165d11465f5466564b17034f445c46174616523d555c505257114f080702395454126e0345435050573a06571000395148395e005c555a43114545460b1312525d39410351551e1b19410b42010c3d145802163f1a101e545017015a0146461a0a465804161819544c1710530a1539464203433d5551571f19421546073e0b525f0756074417191e194344164502134143035f1669454a524b3a01570a49461450025c0b58594a434b0416591646461a114f11191614545657040553163e055f58035f16451004171d1212553b020a5a5408454f08535a685e0016690512155a56086e06574458685b1c3d59060b0350454e11455b5157565e001011484101564539521744425c594d3a17450113395a554e184e16175a5e4b060e5343414f081142580669514b45581c420b44001441501f6e0b58445c454a0001424c41425a553950104451401b19410f570a0001564339520e5f5557434a454b0d441c46175d0f5f0969514b45581c420b44001441501f19421154584358480b5243415b0d11425816535d62105001456b484141575012504f575a584f1e455f0844504a13161258165a551e17045b424514130f5d45001942696f11171e2411450d06081314151116591715176e352169272d2f767f326e3673686d687d2a2f772d2f461a1d46151546536654550c0758104c58504415450d5b6f4d5e4d0907453f46055f58035f16116d62104a423f164a41411316461f421247495466060e5f010f121e0f054411425f54684d0c165a01123d14520f43015a551e6a6242121139414f13185d11465f5e49424d3a034416001f130c4650104451401f19420c57090441130c58114541405a685a0c10550804156c500c501a6d6d1e1b19420b5243415b0d11414612556f5a5e4b060e53173e41131f46150b4255546c1e0c0611394d461447075d175317190a07450b5b140d0957544e11451a1715171d0c066905131452484618421f0b19135801065f1008095d500a6e034442584e195842571613074a19461601594557435c173d40050d135616460c5c1653564257114a164008026c501443034f101017105e42121311056c520a580758441409580601690512155a56086e1259404c47114545550d13055f54411d4211474954550c0758101239505d0f540c426f49565e0011114841425f58085a3d57424b56404942120d0f1646453950104451401b194103520008125a5e08500e69514b45581c421f5f410350590911450a1f5d5e4f5b450d44");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function column_category( $item ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("440800131946581145554d1f19410b42010c3d1452074507515f4b4e1e38421f444846481103520a59101e0b5d0c1416070d0740425b13115542565b553a06571000440d16461f4212594d52543e4555051503545e1448456b1017171e594d520d175814115d111f16");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function column_tags( $item ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4445125256156e034442584e19584241143e015645395e005c555a436611074409124e13150f45075b6b1e5e5d423f1a444611435239450351431e17105e421210000140115b11034442584e114c59164012055b540b50420b1050446616115a4c48460c1141591642404a0d164a45165e41415b45124158191f1e0c194101431613035d453944105a1004171d16015e010c07131f46153d65756b617c3739112c3532636e2e7e3162176417174546693724346574346a45647568627c36366931332f146c5d110459425c565a0d4a16401507544239501044514017581642121000011318464a42124458504a3e3f165941410f50465910535604151e454c160505026c401354104f6f58455e4d42571613074a1946161657571e17045b42121000011e0f1254105b6f5053194c4e164002134143035f1669454b5b194c421844464413520a5011450d1b4049063d4205064413450f450e530d1b10194b424514130f5d45001942696f11171e230b5a10041413531f1116575703171c1645164d4d46174507564f085e585a5c454b164a4141110f41114c16144d565e485c58050c03131f46165e1951071002451f1616041246430811450a4349565745015a0512150e131141016956505b5c3a165703123945500a4407140e1e1717450b5b140d0957544e1145161715171d11035117414f131f46165e19434956575b450d44");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function column_order( $item ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4404055b5e46165e52594f175a090345175c444052145e0e5a6f5d564d044008435a4656520e5e42110c505949101616101816560c445f175b525c451b450c5709045b11520a5807584449565e003d59160503416e41114c161450435c0839110d05416e11481145141050530447015a0d04084741075607695f4b535c173d11444f46175812540f6d1750531e384218444644134212480e530d1b405001165e5e415103411e0a401646585b4c005f1443414813150f45075b6b1e47580207690b13025643416c4218101e15190a0c540814140e1313410657445c6856170653164941131f46150b4255546c1e0c061139414813164f1342190e1e17024507550c0e46140d15410358105a5b5816110b461616506e075b034e6f555858010b5803434640451f5d070b125d5e4a150e571d5b085c5f0313425f54041556170653163e41131f46150b4255546c1e0c06113941481316440f5e19434956575b45165f410350590911450a1f5d5e4f5b45165f41");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function column_date( $item ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4445154750124411160d191f19421243060d0f405941115f0b101d5e4d000f6d43121252451342456b10101706453d694c41416344045d0b45585c531e494261342239707d2f742c626f6d7261313d722b2c277a7f4618420c1066681145457a051212137c09550b50595c531e494261342239707d2f742c626f6d7261313d722b2c277a7f4618420d104b524d10105844465a525304434242594d5b5c584011444f46175812540f6d175d564d00456b444f46141358164218101d5e4d000f6d4305074754416c4218101e0b16040054165f5a5143461e5c111017171d161657101415130a46");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function wpc_get_items_per_page( $attr = false ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("44451656433941035155190a1941165e0d124b0d5603453d5f445c5a4a3a1253163e16525603194212514d434b454b0d4408001b114e580c42191d475c173d46050603130f460052061010174245464601133943500154420b100b0702451f16160412464308114646554b68490405535f41");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 function wpc_set_pagination_args( $attr = array() ) {$cffbf368e5f05610 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4445125b58151c5c45554d684904055f0a00125a5e086e0344574a1f194103421013461a0a46");if ($cffbf368e5f05610 !== false){ return eval($cffbf368e5f05610);}}
 } $ListTable = new WPC_Portalpages_List_Table( array( 'singular' => $this->custom_titles['portal_page']['s'], 'plural' => $this->custom_titles['portal_page']['p'], 'ajax' => false )); $per_page = $ListTable->wpc_get_items_per_page( 'users_per_page' ); $paged = $ListTable->get_pagenum(); $ListTable->set_sortable_columns( array( 'date' => 'date', ) ); if ( isset( $_GET['filter_status'] ) && 'trash' == $_GET['filter_status'] ) { $ListTable->set_bulk_actions(array( 'untrash' => __( 'Restore', WPC_CLIENT_TEXT_DOMAIN ), 'delete' => __( 'Delete Permanently', WPC_CLIENT_TEXT_DOMAIN ), )); } else { $ListTable->set_bulk_actions(array( 'trash' => __( 'Move to Trash', WPC_CLIENT_TEXT_DOMAIN ), )); } $ListTable->set_columns(array( 'cb' => '<input type="checkbox" />', 'title' => __( 'Title', WPC_CLIENT_TEXT_DOMAIN ), 'clients' => $this->custom_titles['client']['s'], 'groups' => $this->custom_titles['client']['s'] . ' ' . $this->custom_titles['circle']['p'], 'category' => __( 'Category', WPC_CLIENT_TEXT_DOMAIN ), 'tags' => __( 'Tags', WPC_CLIENT_TEXT_DOMAIN ), 'order' => __( 'Order', WPC_CLIENT_TEXT_DOMAIN ), 'date' => __( 'Date', WPC_CLIENT_TEXT_DOMAIN ), )); $sql = "SELECT count( p.ID )
    FROM {$wpdb->posts} p
    LEFT JOIN {$wpdb->postmeta} pm1 ON( p.ID = pm1.post_id AND pm1.meta_key = '_wpc_category_id' )
    LEFT JOIN {$wpdb->prefix}wpc_client_portal_page_categories cppc ON pm1.meta_value = cppc.cat_id
    WHERE
        p.post_type = 'clientspage'
        {$where_manager}
        {$where_status}
        {$where_clause}
        {$where_date}
        {$where_cat}
    "; $items_count = $wpdb->get_var( $sql ); $sql = "SELECT p.ID as id, p.post_title as title, p.post_modified as date, p.post_status as status, cppc.cat_name as category, pm2.meta_value as page_order
    FROM {$wpdb->posts} p
    LEFT JOIN {$wpdb->postmeta} pm1 ON( p.ID = pm1.post_id AND pm1.meta_key = '_wpc_category_id' )
    LEFT JOIN {$wpdb->postmeta} pm2 ON( p.ID = pm2.post_id AND pm2.meta_key = '_wpc_order_id' )
    LEFT JOIN {$wpdb->prefix}wpc_client_portal_page_categories cppc ON pm1.meta_value = cppc.cat_id
    WHERE
        p.post_type = 'clientspage'
        {$where_manager}
        {$where_status}
        {$where_clause}
        {$where_date}
        {$where_cat}
    ORDER BY $order_by $order
    LIMIT " . ( $per_page * ( $paged - 1 ) ) . ", $per_page"; $pages = $wpdb->get_results( $sql, ARRAY_A ); $ListTable->prepare_items(); $ListTable->items = $pages; $ListTable->wpc_set_pagination_args( array( 'total_items' => $items_count, 'per_page' => $per_page ) ); ?>

<div class="wrap">

    <?php echo $this->get_plugin_logo_block() ?>

    <?php if( isset( $_GET['trashed'] ) && 0 < (int)$_GET['trashed'] ) { if ( 1 == (int)$_GET['trashed'] ) { echo '<div id="message" class="updated wpc_notice fade"><p>' . __( '1 post Moved to the Trash.', WPC_CLIENT_TEXT_DOMAIN ). '</p></div>'; } else { echo '<div id="message" class="updated wpc_notice fade"><p>' . sprintf( __( '%s posts Moved to the Trash.', WPC_CLIENT_TEXT_DOMAIN ), (int)$_GET['trashed'] ) . '</p></div>'; } } elseif ( isset( $_GET['untrashed'] ) && 0 < (int)$_GET['untrashed'] ) { if ( 1 == (int)$_GET['untrashed'] ) { echo '<div id="message" class="updated wpc_notice fade"><p>' . __( '1 post Restored from the Trash.', WPC_CLIENT_TEXT_DOMAIN ). '</p></div>'; } else { echo '<div id="message" class="updated wpc_notice fade"><p>' . sprintf( __( '%s posts Restored from to the Trash.', WPC_CLIENT_TEXT_DOMAIN ), (int)$_GET['untrashed'] ) . '</p></div>'; } } elseif ( isset( $_GET['deleted'] ) && 0 < (int)$_GET['deleted'] ) { if ( 1 == (int)$_GET['deleted'] ) { echo '<div id="message" class="updated wpc_notice fade"><p>' . __( '1 post Permanently Deleted.', WPC_CLIENT_TEXT_DOMAIN ). '</p></div>'; } else { echo '<div id="message" class="updated wpc_notice fade"><p>' . sprintf( __( '%s posts Permanently Deleted.', WPC_CLIENT_TEXT_DOMAIN ), (int)$_GET['deleted'] ) . '</p></div>'; } } elseif ( !empty( $_GET['msg'] ) && 'empty_clients' == $_GET['msg'] ) { echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'Page has not assigned clients.', WPC_CLIENT_TEXT_DOMAIN ). '</p></div>'; } ?>

    <div class="wpc_clear"></div>

    <style type="text/css">
        .portalpages .column-clients, .portalpages .column-groups, .portalpages .column-order {
            width: 120px;
        }
    </style>
    <div id="wpc_container">

        <?php echo $this->gen_tabs_menu( 'content' ) ?>

        <span class="wpc_clear"></span>

        <div class="wpc_tab_container_block">

            <?php if( current_user_can( 'wpc_admin' ) || current_user_can( 'administrator' ) || current_user_can( 'wpc_manager' ) ) { ?>
                <a href="admin.php?page=wpclients_content&tab=add_client_page" class="add-new-h2" style="z-index: 200;"><?php _e( 'Add New', WPC_CLIENT_TEXT_DOMAIN ) ?></a>
            <?php } ?>

            <?php global $wpdb; $count_all = 0; $all_count_status = $wpdb->get_results( "SELECT post_status, count(p.ID) as count
                FROM {$wpdb->posts} p
                WHERE post_type = 'clientspage'
                    {$where_manager}
                    AND post_status IN ('" . implode( "','", $visible_status ) . "')
                GROUP BY post_status", ARRAY_A ); foreach ( $all_count_status as $status ) { if ( 'trash' != $status['post_status'] ) $count_all += $status['count']; } $filter_status = (string)@$_GET['filter_status']; ?>

            <form action="" method="get" name="wpc_clients_form" id="wpc_portal_pages_form" style="width: 100%;">
                <input type="hidden" name="page" value="wpclients_content" />
                <ul class="subsubsub">
                    <li class="all"><a class="<?php echo ( '' == $filter_status ) ? 'current' : '' ?>" href="admin.php?page=wpclients_content"><?php _e( 'All', WPC_CLIENT_TEXT_DOMAIN ) ?> <span class="count">(<?php echo $count_all ?>)</span></a></li>
                    <?php foreach ( $all_count_status as $status ) { $stat = strtolower( $status['post_status'] ); if ( !in_array( $stat, $visible_status )) { continue; } $class = ( $stat == $filter_status ) ? 'current' : ''; echo ' | <li class="image"><a class="' . $class . '" href="admin.php?page=wpclients_content&filter_status=' . $stat . '">' . ( ( 'publish' == $stat ) ? __( 'Published', WPC_CLIENT_TEXT_DOMAIN ) : ucfirst( $stat ) ) . '<span class="count">(' . $status['count'] . ')</span></a></li>'; } ?>
                </ul>
                <?php $ListTable->search_box( sprintf( __( 'Search %s', WPC_CLIENT_TEXT_DOMAIN ), $this->custom_titles['portal_page']['s'] ), 'search-submit' ); ?>
                <?php $ListTable->display(); ?>
            </form>
        </div>

    </div>

    <script type="text/javascript">
        function update_order( post_id ) {
            clientpage_order = jQuery( '#clientpage_order_' + post_id ).val();
            jQuery( '#order_' + post_id ).css( 'display', 'inline-block' );
            jQuery.ajax({
                type: 'POST',
                dataType    : 'json',
                url: '<?php echo get_admin_url() ?>admin-ajax.php',
                data: 'action=wpc_portal_pages_update_order&post_id='+post_id+'&clientpage_order='+clientpage_order,
                success: function( json_data ){
                            jQuery( '#order_' + post_id ).css( 'display', 'none' );
                            jQuery( '#clientpage_order_' + post_id ).val( json_data.my_value );
                        }
             });
        }

        jQuery(document).ready(function(){

            //reassign file from Bulk Actions
            jQuery( '#doaction2' ).click( function() {
                var action = jQuery( 'select[name="action2"]' ).val() ;
                jQuery( 'select[name="action"]' ).attr( 'value', action );

                return true;
            });


        });
    </script>

</div>