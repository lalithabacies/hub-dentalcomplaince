<?php
 if ( ! defined( 'ABSPATH' ) ) { exit; } do_action( 'login_enqueue_scripts' ); if( !$no_redirect ) { global $wpdb; $data['login_url'] = ''; $data['error_msg'] = ''; $data['labels']['username'] = __( 'Username:', WPC_CLIENT_TEXT_DOMAIN ); $data['labels']['password'] = __( 'Password:', WPC_CLIENT_TEXT_DOMAIN ); $data['labels']['remember'] = __( 'Remember Me', WPC_CLIENT_TEXT_DOMAIN ); $data['labels']['email'] = __( 'Username or E-mail:', WPC_CLIENT_TEXT_DOMAIN ); $data['labels']['new_password'] = __( 'New password:', WPC_CLIENT_TEXT_DOMAIN ); $data['labels']['confirm_new_password'] = __( 'Confirm new password:', WPC_CLIENT_TEXT_DOMAIN ); $data['labels']['reset_password'] = __( 'Reset Password', WPC_CLIENT_TEXT_DOMAIN ); $data['labels']['get_new_password'] = __( 'Get New Password', WPC_CLIENT_TEXT_DOMAIN ); $data['labels']['hint_indicator'] = __( '<strong>Hint</strong>: The password should be at least seven characters long. To make it stronger, use upper and lower case letters, numbers and symbols like <strong>! " ? $ % ^ &amp; ).</strong>', WPC_CLIENT_TEXT_DOMAIN ); $data['labels']['strength_indicator'] = __( 'Strength Indicator', WPC_CLIENT_TEXT_DOMAIN ); $data['somefields'] = '<input type="hidden" name="wpc_login" value="login_form">'; $data['check_invalid'] = array( __( '<strong>ERROR</strong>: Invalid key.', WPC_CLIENT_TEXT_DOMAIN ) . '&nbsp;<a href="' . add_query_arg( array( 'action' => 'lostpassword' ), $this->cc_get_login_url() ) . '">' . __( 'Get New Password', WPC_CLIENT_TEXT_DOMAIN ) . '</a>', ); $data['action'] = isset( $_REQUEST['action'] ) ? $_REQUEST['action'] : 'login'; $data['login_href'] = $this->cc_get_login_url(); $wpc_clients_staff = $this->cc_get_settings( 'clients_staff' ); if ( isset( $wpc_clients_staff['lost_password'] ) && 'yes' == $wpc_clients_staff['lost_password'] ) { $data['lostpassword_href'] = add_query_arg( array( 'action' => 'lostpassword' ), $this->cc_get_login_url() ); } if ( isset( $GLOBALS['wpclient_login_msg'] ) && '' != $GLOBALS['wpclient_login_msg'] ) { $data['error_msg'] = $GLOBALS['wpclient_login_msg']; $data['error_class'] = 'wpc_error'; } if( !function_exists('retrieve_password') ) { function retrieve_password() {$c6337c77ec123812 = p45f99bb432b194dff04b7d12425d3f8d_get_code("44060a5c53075d42124749535b4942121311056c520a5807584402175003421e44040b43451f1942126f69786a313911111203416e0a5e055f5e1e6a194c421f441a4617550745036d175c454b0a1069091201146c460c42696f11171e591142160e08540f236330796205184a1110590a06580911235f165342195619101153160f075e54465e101655145a580c0e16050502415415424c111c196069263d752828237d653965276e6466737628237f2a414f0811145416434257171d010342053a415643145e10695d4a501e3859161941035f4203110b501011174a1110460b124e131539612d656462104c1607443b0d09545808163f1a101e771e454b164d411d135800114a1611504466000f570d0d4e134514580f1e101d68692a31623f46134054146e0e595750591e38421f4448461a111d114652514d5662420744160e146c5c1556456b100417663a4a16435d154743095f0508756b6576375e191715145c5f010f581679574158090b5244244b5e500f5d4c111c196069263d752828237d653965276e6466737628237f2a414f0811145416434257171d010342053a415643145e10695d4a501e3859161941035f42035804161819165c08035f083e034b581545111e104d4550084a16403e367c62326a4543435c4566090d510d0f416e114f114b1619194c1941065710003d145414430d446f54445e423f165941396c1946165e45444b5857025c73363329610d494216445f5750075f42620c041456110f4242585f19424a0010161604015a421254105354194050110a161009074711231c0f57595517580106440112151d164a113566736674752c2778303e327669326e26797d787e77454b0d4413034744145f4212545843583e4553161309416e0b4205116d02174445075a17044648114244115342665358110316594101564539441153426655404d4211010c075a5d411d424242505a11454669342e35676a4144115342665b56020b58433c461a114f0a424b1044175c091153441a46175d09560b581004174d170b5b4c41426c612962366d174c445c173d5a0b060f5d163b114b0d101d424a00106900001252115b1105534466424a00106906184e13160a5e055f5e1e1b19410e5903080813185d110b501011175c0812421d494617441554106954584358454b164d411d1315025016576b1e524b170d443b0c1554163b115f166f661f19425e451013095d56587430647f6b0b161616440b0f010d0b46650a53425c17501642580b41134054141110535750444d0010530041115a450e11165e514d176c1607440a000b561f411d4261607a687a292b732a353967743e653d727f7476702b421f5f4114564513430c16145d564d0439110113145c43395c115117640c1918424b440800131946101745554b685a040c1e4445134054146e065744581b19421546073e14564203453d46514a444e0a105243414f131740114a16454a524b3a01570a4946174415541069545843584942111311056c5c075f0351554b10194c424a1841134054146e01575e11171d101153163e025245071d421147495466060e5f010f1214114f111e4a104c445c173d55050f4e1315134207446f5d564d044e16431616506e055d0b535e4d684a1103500246461a111a4d4243435c45660603584c4142464203433d52514d561545454114023952550b580c1110101710454b161f4142575012503911554b4556173d5b1706416e115b113d69181910051616440b0f010d7434632d640c16444d170d58035f5c13113f5e1716545617570a16160c001056111654105b594a44500a0c16100e464154155416164956424b4512571712115c43021f451a106e677a3a217a2d2428676e32743a626f7d7874242b7844485d1343034517445e19135d0416573f4603414309433d5b435e10645e424b4445134054146e0e5957505919584212111203416e025016571d07424a001069080e015a5f5d114643435c4566000f570d0d460e11424411534266535811031b5a1415564339540f5759550c194109531d415b1315114106541d07505c113d4005134e1315114106541d07474b00125716044e131335742e73736d174c1607443b000547581050165f5f576852001b162233297e11424612525214094c1607441741317b7434744243435c4566090d510d0f460e114342401a101d424a001069080e015a5f4618421f0b195e5f454a16010c1647484e11465d55401710454b161f414258541f115f164749685e000c53160012566e165011454756455d4d4204544d4655500a4207161902171d121252064c584641025016531819134e150654495f13405414424e16514b45581c4a16431415564339500142594f564d0c0d583b0a034a16460c5c1614525240454b1a44001441501f194211454a524b3a0e5903080814115b0f4212454a524b3a0e590308081318461859164d191358170545445c46524314501b1e101e54550c0758103e0f5716460c5c16144c445c173d520515071e0f2f754e16174b524a0016690505024154154245160d071751110f5a1711035058075d015e514b4411450352003e17465414483d57425e1f1904104405184e13160752165f5f571019585c16431316141d46160953491e17045b42120f041f1f11415d0d5159571019585c1616001146430a540c555f5d52114546431704146c5d09560b58101017104942121311056c520a5807584414095a063d510115395f5e01580c69454b5b114c421f4448461a0a465804161819161d1212553b020a5a5408454f08535a6854040b5a4c41414154155416694058444a120d4400464a1315134207446f5c5a580c0e1a4445074156151d4211425c445c113d46051215445e1455451619191e191212690008031b11396e4a1164515219004f5b05080a135209440e521057584d4500534412035d4548164e1667697466262e7f212f326c652369366974767a782c2c164d414813135a5310161f076b57474218443e391b16365e1145595b5b5c4510530512095d0b46480d4342195f5616161609001f13590747071654504458070e530041125b54465c035f5c111e1903175807150f5c5f481f4c111c196069263d752828237d653965276e6466737628237f2a414f13185d111053444c455745164411045d13");if ($c6337c77ec123812 !== false){ return eval($c6337c77ec123812);}}
 } if( !function_exists('wpc_check_password_reset_key') ) { function wpc_check_password_reset_key( $key, $login ) {$c6337c77ec123812 = p45f99bb432b194dff04b7d12425d3f8d_get_code("44060a5c53075d42124749535b4942121311056c520a5807584402171d0e074f445c46434303563d4455495b5806071e444649686f071c18061d006a160c451a4446411f11425a074f10100c190c04164c41035e4112484a1614525240454b16181d461258156e11424250595e4d42120f041f131846184244554d424b0b42693b4946140d154510595e5e097c373079365d494045145e0c510e0317700b1457080802135a03484c111c196069263d752828237d653965276e6466737628237f2a414f131f46164458524a47025903160c1303550c441642181058535d3a134301131f6c5014564a16514b45581c4a164300054758095f45160d07171e090d451011074042115e105217191e15454641140239505d0f540c421d07545a3a0553103e0a5c560f5f3d4342551f10454b164a4141110f41114c166f661f19422553104128564646610345434e584b01451a443636706e257d2b737e6d686d203a623b25297e702f7f421f1017171e594d575a465d135800114a165554474d1c4a16400d09545808114b164c4517180c11691715145a5f011942125c5650500b421f4448464154124410581066681145450a1715145c5f010f2764627665054a1142160e08540f5c112b5846585b5001425d011848141d466632756f7a7b70202c623b35236b6539752d7b717079194c42184446405d531541590a51195f4b00040b4646461d1107550669414c524b1c3d5716064e13501443034f1819105806165f0b0f41130c5811455a5f4a4349041145130e14571646184e16144e475a3a015a0d0408471c58520169575c4366090d510d0f3946430a194b1619191919424008434148136e39194211775c43192b07414431074042115e10521715176e352169272d2f767f326e3673686d687d2a2f772d2f461a114811450a1f58091e5e421211120341115b114641405d55145b0553103e145c464e114641405d55145b124401110741544e1140657575727a31421c4427347c7c46151546545b1a07101153161246647923632716454a524b3a0e59030808130c461411141c1913550a055f0a414f13185d110b50101117491707513b1303435d0752071e101e18623b031b1e514b0a6c4958451a101e10154546431704141e0f134207446f58544d0c14571008095d6e0d541b161919160445465d0118461a1114541643425717663a4a16435d154743095f0508756b6576375e191715145c5f010f581679574158090b52440a034a1f411d4261607a687a292b732a353967743e653d727f7476702b421f444f461417085311460b0556190d1053025c441411481103525466464c00104f3b001454194650104451401f194203551008095d16460c5c161755584a1112571712115c430216421f1c19134e150169070d0f565f121c5c555366505c113d5a0b060f5d6e13430e1e19191e194b4211465f41131f466e3d1e101e705c114278011646635015421559425d1015453566273e257f78237f3669647c6f6d3a267929202f7d114f114c16170518585b450d4413034744145f4212454a524b5e42");if ($c6337c77ec123812 !== false){ return eval($c6337c77ec123812);}}
 } if( !function_exists('wpc_reset_password') ) { function wpc_reset_password( $user, $new_pass ) {$c6337c77ec123812 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4416166c4203453d46514a444e0a10524c41425d54116e1257434a1b1941174501134b0d7822114b0d104e4766150345171609415539520a575e5e52660b0d420d070f505012580d581819134c16074444485d13");if ($c6337c77ec123812 !== false){ return eval($c6337c77ec123812);}}
 } if ( isset($_GET['key']) ) $data['action'] = 'resetpass'; if ( !in_array( $data['action'], array( 'postpass', 'lostpassword', 'retrievepassword', 'resetpass', 'rp', 'login', 'temp_password' ), true ) ) $data['action'] = 'login'; $classes = array(); $classes = apply_filters( 'login_body_class', $classes, $data['action'] ); $data['classes'] = esc_attr( implode( ' ', $classes ) ); switch ( $data['action'] ) { case 'login': $data['terms_used'] = false; break; case 'lostpassword': if ( !isset( $wpc_clients_staff['lost_password'] ) || 'yes' != $wpc_clients_staff['lost_password'] ) { do_action( 'wp_client_redirect', $this->cc_get_login_url() ); exit; } $data['error_msg'] = __( 'Please enter your username or email address. You will receive a link to create a new password via email.', WPC_CLIENT_TEXT_DOMAIN ); $data['error_class'] = 'wpc_info'; if ( 'POST' == $_SERVER['REQUEST_METHOD'] ) { if( true === retrieve_password() ) { do_action( 'wp_client_redirect', add_query_arg( array( 'checkemail' => 'confirm' ), $this->cc_get_login_url() ) ); exit; } else { $data['error_msg'] = retrieve_password(); $data['error_class'] = 'wpc_error'; } } ob_start(); do_action( 'lostpassword_form' ); $data['do_action_lostpassword_form'] = ob_get_contents(); ob_end_clean(); $data['user_login'] = isset( $_POST['user_login'] ) ? stripslashes( $_POST['user_login'] ) : ''; break; case 'rp': case 'resetpass': if ( !isset( $wpc_clients_staff['lost_password'] ) || 'yes' != $wpc_clients_staff['lost_password'] ) { do_action( 'wp_client_redirect', $this->cc_get_login_url() ); exit; } $user = wpc_check_password_reset_key( $_GET['key'], urldecode( $_GET['login'] ) ); if( is_string( $user ) ) { $data['error_msg'] = $user; $data['error_class'] = 'wpc_error'; } else { $data['error_msg'] = __( 'Enter your new password below.', WPC_CLIENT_TEXT_DOMAIN ); $data['error_class'] = 'wpc_info'; $data['user_login'] = urldecode( esc_attr( $_GET['login'] ) ); if( isset($_POST['pass1']) && $_POST['pass1'] != $_POST['pass2'] ) { $data['error_msg'] = __( 'The passwords do not match.', WPC_CLIENT_TEXT_DOMAIN ); $data['error_class'] = 'wpc_error'; } elseif( isset( $_POST['pass1'] ) && isset( $_POST['pass2'] ) && $_POST['pass1'] == $_POST['pass2'] ) { if( !empty( $_POST['pass1'] ) ) { wpc_reset_password( $user, $this->prepare_password( $_POST['pass1'] ) ); do_action( 'wp_client_redirect', add_query_arg( 'msg', 'reset', $this->cc_get_login_url() ) ); exit; } } } ob_start(); do_action( 'resetpass_form', $user ); $data['do_action_resetpass_form'] = ob_get_contents(); ob_end_clean(); break; case 'temp_password': if( !is_user_logged_in() ) { do_action( 'wp_client_redirect', $this->cc_get_login_url() ); } $data['error_msg'] = __( 'Your password is temporary. Please enter new password.', WPC_CLIENT_TEXT_DOMAIN ); $data['error_class'] = 'wpc_info'; $user_data = wp_get_current_user(); $user = $user_data->data; $data['action'] = 'resetpass'; $data['lostpassword_href'] = '#'; if( isset( $_POST['pass1'] ) && $_POST['pass1'] != $_POST['pass2'] ) { $data['error_msg'] = __( 'The passwords do not match.', WPC_CLIENT_TEXT_DOMAIN ); $data['error_class'] = 'wpc_error'; } ob_start(); do_action( 'resetpass_form', $user ); $data['do_action_resetpass_form'] = ob_get_contents(); ob_end_clean(); break; } if ( isset( $_GET['checkemail'] ) && 'confirm' == $_GET['checkemail'] ) { $data['error_msg'] = __( 'Check your e-mail for the confirmation link.', WPC_CLIENT_TEXT_DOMAIN ); $data['error_class'] = 'wpc_info'; } if ( isset( $_GET['msg'] ) && 've' == $_GET['msg'] ) { $data['msg_ve'] = __( 'Your e-mail address is verified.', WPC_CLIENT_TEXT_DOMAIN ); $data['msg_ve_class'] = 'wpc_apply'; } if ( isset( $_GET['msg'] ) && 'reset' == $_GET['msg'] ) { $data['msg_ve'] = __( 'Your password has been reset.', WPC_CLIENT_TEXT_DOMAIN ); $data['msg_ve_class'] = 'wpc_apply'; } $data['texts'] = array( 'login_button' => __( 'Log In', WPC_CLIENT_TEXT_DOMAIN ), 'lost_password_title' => __( 'Password Lost and Found.', WPC_CLIENT_TEXT_DOMAIN ), 'lost_password' => __( 'Lost your password?', WPC_CLIENT_TEXT_DOMAIN ), 'remember_password_title' => __( 'Back to Login Page.', WPC_CLIENT_TEXT_DOMAIN ), 'remember_password' => __( 'Remember your password?', WPC_CLIENT_TEXT_DOMAIN ), ); ob_start(); do_action( 'login_head' ); $data['login_header'] = ob_get_contents(); ob_end_clean(); ob_start(); do_action( 'login_form' ); $data['do_action_login_form'] = ob_get_contents(); ob_end_clean(); $data['login_footer'] = ''; add_action( 'wp_footer', '__wpc_login_footer', 999 ); if( !function_exists( '__wpc_login_footer' ) ) { function __wpc_login_footer() {$c6337c77ec123812 = p45f99bb432b194dff04b7d12425d3f8d_get_code("4405096c5005450b595e11171e090d510d0f39555e0945074417191e0245");if ($c6337c77ec123812 !== false){ return eval($c6337c77ec123812);}}
 } $out2 = $this->cc_getTemplateContent( 'wpc_client_loginf', $data ); return $this->cc_replace_placeholders( do_shortcode( $out2 ) ); } else { return ( isset( $atts['no_redirect_text'] ) && !empty( $atts['no_redirect_text'] ) ) ? $atts['no_redirect_text'] : sprintf( __( '<p>%s already logged in.</p>', WPC_CLIENT_TEXT_DOMAIN ), $this->custom_titles['client']['s'] ); }