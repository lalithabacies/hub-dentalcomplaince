<?php
global $wpdb, $wpc_client; if ( isset($_REQUEST['_wp_http_referer']) ) { $redirect = remove_query_arg(array('_wp_http_referer' ), wp_unslash( $_REQUEST['_wp_http_referer'] ) ); } else { $redirect = get_admin_url(). 'admin.php?page=wpclients_feedback_wizard'; } if ( isset( $_GET['action'] ) ) { switch ( $_GET['action'] ) { case 'delete': $ids = array(); if ( isset( $_GET['wizard_id'] ) ) { check_admin_referer( 'wpc_wizard_delete' . $_GET['wizard_id'] . get_current_user_id() ); $ids = (array) $_REQUEST['wizard_id']; } elseif( isset( $_REQUEST['item'] ) ) { check_admin_referer( 'bulk-' . sanitize_key( __( 'Wizards', WPC_FW_TEXT_DOMAIN ) ) ); $ids = $_REQUEST['item']; } if ( count( $ids ) ) { foreach ( $ids as $wizard_id ) { $wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->prefix}wpc_client_feedback_wizards WHERE wizard_id = %d", $wizard_id ) ); $wpdb->query( $wpdb->prepare( "DELETE FROM {$wpdb->prefix}wpc_client_feedback_wizard_items WHERE wizard_id = %d", $wizard_id ) ); $wpc_client->cc_delete_all_object_assigns( 'feedback_wizard', $wizard_id ); } do_action( 'wp_client_redirect', add_query_arg( 'msg', 'd', $redirect ) ); exit; } do_action( 'wp_client_redirect', $redirect ); exit; case 'sent': if ( isset( $_GET['wizard_id'] ) ) { $wizard_id = $_REQUEST['wizard_id']; if ( 0 < $wizard_id ) { $wizard_data = $wpdb->get_row( $wpdb->prepare( "SELECT * FROM {$wpdb->prefix}wpc_client_feedback_wizards WHERE wizard_id = %d", $wizard_id ), ARRAY_A ); $send_client_ids = array(); $send_client_ids = $wpc_client->cc_get_assign_data_by_object( 'feedback_wizard', $wizard_id, 'client' ); $send_group_ids = $wpc_client->cc_get_assign_data_by_object( 'feedback_wizard', $wizard_id, 'circle' ); if ( is_array( $send_group_ids ) ) { foreach( $send_group_ids as $group_id ) { $send_client_ids = array_merge( $send_client_ids, $wpc_client->cc_get_group_clients_id( $group_id ) ); } } $send_client_ids = array_unique( $send_client_ids ); if ( is_array( $send_client_ids ) && 0 < count( $send_client_ids ) ) { $send1 = 0; $send2 = 0; foreach( $send_client_ids as $send_client_id ) { if ( '' != $send_client_id ) { $send1 = 1; $sql = "SELECT result_id FROM {$wpdb->prefix}wpc_client_feedback_results WHERE wizard_id = %d AND client_id = %d AND wizard_version = '%s' "; $result_id = $wpdb->get_var( $wpdb->prepare( $sql, $wizard_data['wizard_id'], $send_client_id, $wizard_data['version'] ) ); if ( empty( $result_id ) || 0 > $result_id ) { $send2 = 1; if ( $wpc_client->permalinks ) { $wizard_link = $wpc_client->cc_get_slug( 'feedback_wizard_page_id' ) . $wizard_data['wizard_id']; } else { $wizard_link = add_query_arg( array( 'wpc_page' => 'feedback_wizard', 'wpc_page_value' => $wizard['wizard_id'] ), $wpc_client->cc_get_slug( 'feedback_wizard_page_id', false ) ); } $args = array( 'client_id' => $send_client_id, 'wizard_name' => $wizard_data['name'], 'wizard_url' => $wizard_link ); $client_email = get_userdata( $send_client_id )->get( 'user_email' ); $wpc_client->cc_mail( 'wizard_notify', $client_email, $args, 'wizard_notify' ); } } } if ( 0 == $send1 && 0 == $send2 ) { $msg = 'ns1'; } else if ( 1 == $send1 && 0 == $send2 ) { $msg = 'ns2'; } else { $msg = 's'; } } else { $msg = 'ns1'; } do_action( 'wp_client_redirect', add_query_arg( 'msg', $msg, $redirect ) ); exit; } do_action( 'wp_client_redirect', $redirect ); exit; } } } if ( !empty( $_GET['_wp_http_referer'] ) ) { do_action( 'wp_client_redirect', remove_query_arg( array( '_wp_http_referer', '_wpnonce'), wp_unslash( $_SERVER['REQUEST_URI'] ) ) ); exit; } $where_clause = ''; if( !empty( $_GET['s'] ) ) { $where_clause .= $wpc_client->get_prepared_search( $_GET['s'], array( 'fw.name', 'fi.name', ) ); } $where_filter = ''; if ( isset( $_GET['change_filter'] ) ) { switch ( $_GET['change_filter'] ) { case 'client': if ( isset( $_GET['select_filter'] ) ) { $select_filter = $_GET['select_filter']; $client_wizards = $wpc_client->cc_get_assign_data_by_assign( 'feedback_wizard', 'client', $select_filter ); $where_filter .= " AND fw.wizard_id IN('" . implode( "','", $client_wizards ) . "')"; } break; case 'circle': if ( isset( $_GET['select_filter'] ) ) { $select_filter = $_GET['select_filter']; $circle_wizards = $wpc_client->cc_get_assign_data_by_assign( 'feedback_wizard', 'circle', $select_filter ); $where_filter .= " AND fw.wizard_id IN('" . implode( "','", $circle_wizards ) . "')"; } break; } } $order_by = 'time'; if ( isset( $_GET['orderby'] ) ) { switch( $_GET['orderby'] ) { case 'name' : $order_by = 'name'; break; case 'items' : $order_by = 'items'; break; } } $order = ( isset( $_GET['order'] ) && 'asc' == strtolower( $_GET['order'] ) ) ? 'ASC' : 'DESC'; if( ! class_exists( 'WP_List_Table' ) ) { require_once( ABSPATH . 'wp-admin/includes/class-wp-list-table.php' ); } class WPC_Feedback_List_Table extends WP_List_Table { var $no_items_message = ''; var $sortable_columns = array(); var $default_sorting_field = ''; var $actions = array(); var $bulk_actions = array(); var $columns = array(); function __construct( $args = array() ){$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("431350420116435816154267125614450668504201164b451203405f111b4657114550494e4544165f0c554d0e561411430a0f10393a4b45110b465d0f104a163467726f20323c31733a666726782b772a7911194a4544155a1740590e10460b5d176e6f4e45440c42075f4b451b466133746e76313a37206e366d7c2d7a277f2d17181c4642020f571a15185f094650025b4255464c434c0d42164c0a5e151b5d595e6f0f110608453d5f5d1144075106170c1042041102453915480e4214570f106c104845444511421c183d684e1644595e4446030c1058061c1f4e173166206877673931263d623d76772f762f78431e0a1016041100581608023d6805590d4445421306174d1646534a0544461f5817");if ($c215aa63d6167b06 !== false){ eval($c215aa63d6167b06);}}
 function __call( $name, $arguments ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("4345544413170d4555035e543d4215531168574508063c04441053414a170744115648184641170d5f111e184659075b0617181c4641021751175f5d0c4315164a0c11");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function prepare_items() {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("4313525f0a100e0b45420f1846430e5f101a0f5703113c06590e47550c444e1f581715580f01070058420f18034514571a1f180b4641100a4416535a0e52460b431345580f164e5b510746671158144202555d5539060c09430f5c4b4a1e5d164743595915485d3a550d5e4d0f59395e06565555141643581603404a034e4e1647545e5c13080d161a4216500b5302530d1b1114150a111157005e5d421e5d16");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function column_default( $item, $column_name ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("435e5718460c101653161a18465e12530e6c1114050a0f105b0c6d56035a03163e1718104f4518454407464d105946120a43545d3d454706590e47550c6808570e52116d5d451e45530e415d424c464406434442084544420d424f18");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function no_items() {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("436854184641170d5f111f060c58395f17525c43390806164503555d4e173166206877673931263d623d76772f762f78431e0a10");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function set_sortable_columns( $args = array() ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("431343551210110b6903405f11175b16024543511f4d4a5e16045d4a0756055e4b171551140210455711121c090a581215565d104f4518455f041a180b443958165a54420f064b4512091211421e464d431343551210110b6903405f116c461215565d103b455e45571040591b1f461215565d1c464115045a420f054213125e0a441c0e02000504430e4667115814420a59566f000c060952421b03424a46530f4454100f034b455f116d4b16450f58041f11140d454a451f4249184645034216455f6f071704166d421653426a460b43564342071c4b45121453544e17425d430a0c1042110b0c454f0c5c075107430f436e430917170c58056d5e0b520a52431e0a101b4506094507124342540958175e5f45035e4318161f121c165f0f454e09425f141102075a076d5b0d5b135b0d44110d46411100421740563d561451100c1142031116175842164c0a5e150d43");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function get_sortable_columns() {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("4345544413170d4512165a51111a58450c4545510409063a550d5e4d0f59150d43");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function set_columns( $args = array() ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("435e571846060c1058161a1846430e5f101a0f521309083a570146510d5915164a1718101d454704440541185f1707441156486f0b001102534a12591045074f4b17165304424358084215040b5916431717454916005e47550a575b0955094e41171e0e41454a491646534a0544461f58174c1042110b0c454f0c5b0d5b135b0d44110d46410217511109181052124311591114120d0a160d42");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function get_columns() {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("4345544413170d4512165a51111a58550c5b445d08165845");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function set_actions( $args = array() ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("431345580f164e5b570146510d5915165e1715511402105e1610574c1745081647435959155e43");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function get_actions() {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("4345544413170d4512165a51111a58570043585f08165845");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function set_bulk_actions( $args = array() ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("431345580f164e5b54175e533d5605420a585f43465843415710554b591714531742435e4641170d5f110918");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function get_bulk_actions() {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("4345544413170d4512165a51111a5854165b5a6f0706170c590c410342");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function column_cb( $item ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("4345544413170d45451240510c43001e43100d590815161116164b48070a44550b52525b040a1b47160c5355070a445f17525c6b3b474313570e475d5f15434541171e0e414943415f1657553910115f19564354390c07426b421b0342");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function column_time( $item ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("43505d5f04040f451215425b3d540a5f0659450b4617061143105c18464016553c545d59030b174808015167065612533c515e420b04174d16465b4c075a3d11175e5c554138434c0d42");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function column_clients( $item ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("43505d5f04040f451215425b3d540a5f0659450b4641001044105756166816570452110d460c101653161a1846682173376c1640070206426b421b185d1742692472656b4115020253456f1858174111581715530a0c060b42111205421311460068525c0f000d111b5c515b3d5003423c5642430f020d3a520346593d551f690c555b5505114b451104575d06550755086846591c041101114e121c0b43035b381046591c041101690b561f3f1b4611005b5855081144451f59121c015b0f530d43426f0f0110450b4251571759121e4313525c0f000d1145421b0342130a5f0d5c6e511417021c165f12591045074f4b171654071102485f0615185f0946120a43545d3d42140c4c03405c3d5e02113e1b1117020417041b0358591a10460b5d17001c4642170c420e571f420a5816104743590811054d163d6d1042102745105e565e46401045420d1514426036753c71666f32203b3169267d75237e28164a1b11141115003a550e5b5d0c434b080042424409083c115f165e5d116c41550f5e545e12423e3e11121565421e461843101117464b43415f165755391008570e52166d464c5845120b5c48174339571145504946584304441053414a174158025a541746585d451115425b3d540a5f06594543390409044e396f1f4e17415f0710110d5845441246016d5b0e5e035817446e17464b43415f1657553910115f19564354390c07426b4e121f14560a430610110d58450a08460e5d5c071f46114f101d1042060f0c530c464b421e461f5817155102010a115f0d5c590e680744115648105b45021744034b104210055916594555143a15045a17571f420a581647545d59030b1716690b564b4e17414113546e510c041b3a4610575e0b4f41165e091117001244451f59121c0a430b5a430a11141115003a550e5b5d0c434b080254526f0716100c510c6d480d4713464b10525c0f000d11114e1251114403424b1715531317110058166d48035003164a170e104206161744075c4c3d47075106170b1041424f45120e5b56096807441156481c46410a0b46174667034514571a1b11140701070c420b5d56035b3957114550494a4505045a1157184b0c4644064344420845470d420f5e0342");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function column_circles( $item ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("43505d5f04040f451215425b3d540a5f0659450b4641001044105756166816570452110d460c101653161a1846682173376c1640070206426b421b185d1742692472656b4115020253456f1858174111581715530a0c060b423d554a0d421645430a11141115003a550e5b5d0c434b0800546e5703113c0445115b5f0c68025717566e521f3a0c075c07514c4a174150065255520706083a410b48591053411a4313584403083842410b48591053395f07106c1c4642000c44015e5d45174f0d4313525f130b17450b4251571759121e4313525c0f000d1169054057174715164a0c11140a0c0d0e6903404a034e460b43564342071c4b451106534c031a0f5244170c0e46410a11530f691f155e1c5711536e5902423e491645565916564b570956491746585d45074e121f165e125a0610110d58451015440b5c4c041f46693c1f11172716100c510c121d11171259441b116736263c23613d667d3a6339722c7a707928454a49164645480168055a0a525f444b5b001045165d553d430f420f52426b41060f0c530c461f3f6c4146446a1119464b43421645121642130f42065a6a1708040e00113f12115917425f0d47444439041117571b120542561444024e1910410b0208534512055c17414113546e530f17000953116d5908561e6d3e101d10410c0742165f0c18454016553c545842050906166945121642130f42065a6a17110c190444066d5106103b1a431047510a100642165f0c180b5a165a0c53541846424f421a42165b0e5e03581768564209101316164b121159174257075358440f0a0d045a3d534a10561f165e17504214041a4d1645515717591253116847510a100642165f0c18465409430d431d1041121306690358591a6816440651584841455e5b1645544f45174f0d431359440b094358164645480168055a0a525f444b5b0206553d534b115e01583c475e4013154b42550b405b0e52411a435e424303114b451201474a105208423c47505703454a450942165b174514530d436e40070206450c42151f4e17425a0a595a6f071711044f4e121c0b5916431768504214041a491646535c065e125f0c59505c39041117571b1e1804560a450617180b4617061143105c18465f125b0f170a10");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function column_name( $item ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("43505d5f04040f451215425b3d540a5f0659450b46410206420b5d5611175b16024543511f4d4a5e1646535b165e0958106c1655020c17426b420f18450b07160b4554565b4702015b0b5c16125f1609135656555b1213065a0b575616443950065255520706083a410b48591053404202550c55020c173a410b4859105340410a4d5042023a0a010b45121642130f42065a6a17110c190444066d5106103b164d1716125842434b163d6d10421023520a43161c463233266924656736723e623c737e7d272c2d451f4c121f5e180708440c11140706170c590c41634553035a064354173b455e45115e53180d59055a0a545a0d3a4211004217405642540958055e435d4e47444518426d674a17417711521149091043164310571816584652065b54440345170d5f11126f0b4d07440708161c463233266924656736723e623c737e7d272c2d451f421c1845154f0d3f10115814000558140356550b5948460b470e4007020658411251540b520842106857550301010455096d4f0b4d074407115053120c0c0b0b06575407430310145e4b5114013c0c525f15184c17425f17525c6b41120a1f571056670b53416b43191117403a1415580d5c5b070a41164d17464039061100571657670c580855061f11171115003a410b485910533952065b54440342434b16465b4c075a3d11145e4b5114013c0c52456f184c170153176852451417060b423d474b0745395f071f18104f454d4511446d4f12680e4217476e420303061753100f1f42194643115b545e050a07001e4245483d4208450f5642584e45473a6527606e27653d11317260652336373a63307b1f3f174f164a171f104147435b11421c183d684e164473545c031106456607405503590358175b48174a453435753d746f3d63236e3768757f2b242a2b164b121642105a190209160b46410206420b5d56116c4145065955173b455e45115e53180a4503505e1550540b0c0d4b460a4207125601535e4041530a0c060b42116d5e0752025402545a6f110c19044406145901430f590d0a4255081145125f18534a06680f525e10111e46410a11530f691f155e1c5711536e5902423e451842151e3d4016580c5952555b42434b161542670145035717526e5e090b00001e42154f125439410a4d5042023a1000580615184c17425f17525c6b41120a1f571056670b53416b4319115703113c064310405d0c4339431052436f0f014b4c164b12164210440844171f101515110c581654104268391e43106255080143205b035b5442430916464419434f424f456132716724603962266f656f222a2e247f2c12114e17424113546e530a0c060b424f0c5b174412590e684559120906166d4551540b520842446a6a1715423e451f421c18450b49575d100a1014001710440c124b12450f5817511917435447161647001c11104a16440b50100e1706030b40535c0f5e0818135f410f160404000b15425b0e5e035817446e560300070757015967155e1c571153174407075e00520b4667155e1c57115317470f1f0217523d5b5c5f1046184313584403083842410b48591053395f07106c10484544470845121642130f42065a6a1708040e00113f121642105a190209161c4641170d5f111f061058116902544559090b104d1646535b165e0958101718104f5e43");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function extra_tablenav( $which ){$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("435e57104e454411591215185f0a4612145f58530e454a454d4255540d55075a4313464002074f451215425b3d540a5f0659450b464102095a3d54510e430344430a11511417021c1e42164f125439550f5e545e12485d06431146570f68125f175b54433d4200095f075c4c456a3d1110106c105b5b4342550e5b5d0c43411a43134640053a00095f075c4c4f09054310435e5d39110a115a07416345540f44005b54173b3e4416113f12055c1741550a45525c03424f451f59121c035b0a6904455e45161643581603404a034e4e1f581715510a093c065f105154074439511158444015455e451215425c001a585106436e420316160942111a184064237a2674651001170c10463d5b5c4e1701440c42416f08040e00162460772f171d12144755524b5b131753045b401f4016553c545d59030b173a51105d4d1244441a4315706234243a3a7740121159170059115250530e454b4512035e543d540f44005b54433902110a431241180344461215565d4503454a454d4216590e5b395111584440153e434140035e4d076c415111584440390c07426b426f185f174240025b44553d420417591742670c560b53446a0a101b455c5b3b683f326f3d46164317111046455f015f14125b0e5615455e15505c0f020d09530446180354125f0c5942125868694516421218421746164317110c15000f0055161256035a030b415459510802063a500b5e4c074544160a530c12050d020b51076d5e0b5b125311151143121c0f000b4054540d56120c0f5257445d475d683c421218421746164317111046454345165e5d48165e09584341505c13005e471b5310185e08165e131758564e45420c4511574c4a1742692472656b41060b0458055767045e0a420645166d464c43194a4213510c6807441156481846413c227336691f015f075804526e560f09170044456f144213075a0f6857590a110617164b12114252055e0c171643030906064207561f591759085d0b0e400e15433a534a121f31520a53004311760f09170044451e183567256925606e64233d373a722d7f792b79461f43080f0c490a13115f0d5c066f3d461643171110464543451642121842175a09135f413d6c45050a4407535b0a174e1647565d5c39030a094207401803444612085248105b5b4341421b425d3d510f5a175243104f451845121157540754125307170c104e450a16450746104213397126636a17050d020b51076d5e0b5b125311106c104f45454316464641125239500a5b455514455e5816466d7f27633d11005f505e01003c035f0e465d10103b164a170e10414510005a07514c0753411659171617465e4300550a5d18450b0946175e5e5e4613020943070f1a4517481647434840033a050c5a16574a421946114110111e464110005a07514c075346184310110e41454d45693d1a18465c034f4f176660253a253269367760366822792e76787e464c434b16450e170d47125f0c590f175d451e45095c3f324217461643171110464543450a4d415d0e5205425d3a3b1046454345164212184217460a10525d550511430b570f57054044035a0654456f000c0f11531010180b535b1410525d5505113c035f0e465d10154645174e5d555b470509590346020e52004258170d0f160d13455f04121042160f451052451846413c227336691f015f075804526e560f09170044456f184b171a4a4316585e39041117571b1a1846682173376c16530e040d02533d54510e430344446a1d1042040f0969045b54165214164a17181003060b0a1645125c0b44165a024e0b10080a0d000d4509185d0944086e3d111046454345164212184217461643170d0f160d13683c425b5e421f465f104454444e45473a7127666345540e570d50546f000c0f1153101565421e461f434c115900454b4511015e5107591211430a0c10423a24206239155b0a560851066857590a110617113f121e44170f451052451846413c227336691f11520a5300436e560f09170044456f184b174f1618171545080c1210533d51540b520842430a11141115003a550e5b5d0c434b0800546e5703113c0445115b5f0c68025717566e521f3a0c075c07514c3d5615450a505f184642050053065059015c39410a4d504202424f4511015e5107591211431e0a10595b6e6f164212184217461643171110464543451642121842174616431711105a0a13115f0d5c1814560a43060a131d5747435909125a48425e00164b171059083a021744034b104213397126636a1715000f0055166d5e0b5b125311106c1c4641160b5f13475d3d540a5f065945104f454a4553015a57421015530f5252440301445e165d0c065e08165e131741420f0b17031e426d674a174165065b545312454616114e126f32743970346865753e313c21792f73712c174f1a43134640053a00095f075c4c4f09054310435e5d39110a115a07416345540a5f065945173b3e4416113f12114208580a4c5841440f0a0d5b3b68121842174616431711104645434516421218421746164317111046455f5a460a423568170f50431f1159153a021744034b10421313580a46445539060f0c530c46184b1740104307110c46060c1058161a184642085f1242546f05090a0058161211421e46500c455451050d4b4512175c5113420369005b5855081143044542165b0e5e035817685854464c431e160b54184a17411143160c1042060f0c530c46670b53461f434c111415000f005516575c420a461e4313525c0f000d11690b56185f0a46123c7074643d4210005a07514c3d510f5a175243173b454a450942154b075b035517525517465f43421159125d015f0916440b5e40120c0c0b1614535417525b1444171f1042060f0c530c46670b5346184310131041454d45121157540754125307171f1041455d42164c125f07433943105243540711024d164651540b5208423c5e55104f485d10450740670e58015f0d171f1041594c0a46165b570c09410d434a114d461843005a11575104174e164454584205090642165f0f1846682173376c16530e040d02533d54510e430344446a111640450a16450746104213397126636a1715000f0055166d5e0b5b125311106c104f454a454d42164d0c5e17430668525914060f00165f121c15470569005b585508114e5b55016d5f0743395710445857083a070442036d5a1b68095409525244390410165f055c104210005306535351050e3c125f18534a06104a164454584205090642164b09184642085f1242546f050c11065a0712054213114607551c0e0100173a4407414d0e43151e431562752a202031160540571747395f071b1157140a1615690c5355071720642c7a114b42121301544f0c481052005f1b4a4640053a00095f075c4c3d50145916474210312d26377342554a0d4216690a531179284d4447164c12510f470a590752191044424f42144e121c17590f4716526e530f17000953421b184c1744114a151d10273731246f3d73184b0c46095d3a3b104645434516421218421746164317111046454345164212184217460a0c474559090b4313570e475d5f154b0741170d0f160d13455f04121042160f583c564342071c4b45123d757d366c4145065b5453123a050c5a16574a456a4a1647425f591710063a550b405b0e52461f431e1155050d0c45111157540754125307100a10595b5d5909125a484247145f0d435718463a3c4d1645615d0e520542431242174a453435753d746f3d63236e3768757f2b242a2b164b1e18464016553c545d59030b17480801474b16580b69175e455c03163842550b405b0e52416b381042173b454a45095c0e170d47125f0c590f3d6c454345164212184217461643171110464543451642121842174616430b0e400e156e6f160b54184a170f453c564342071c4b4512175c5113420369005e43530a00434c1644141852175a160058445e124d4341430c5b49175239550a45525c03454a451f42491804581453025459184641160b5f13475d3d540f44005b541007164341550b405b0e52395f071718101d450a03164a121f4517470b4313525914060f00690b56634550145916476e5902423e451f4249184644035a0654455502455e451e42165b0b45055a066858543d420417591742670b53416b430a0c10423a24206239154b075b0355176857590a110617113f12114208461110525d55051106011142081845105d160654595f46425f0a46165b570c1710570f42540d4442434b1646515110540a533c5e556b4102110a43126d5106103b164d1716124642434b1646415d0e5205420653111e4642435b11421c1846540f44005b546f0f01384251105d4d126808570e52166d464b43420a4d5d48165e09585d100a101b451e454b424f181f1759086e3d1110464543451642121842175a1910525d5505115d683c421218421746164317111046591015570c1251060a445a0c56556f15000f0055166d5e0b5b125311150f0c49161304585c3f324217461643171110464543450a0b5c48174346421a47540d44071611420d5c1a4241075a16520c125a5a130d46426d5d4a1741700a5b455514424f456132716724603962266f656f222a2e247f2c12114208581443545d5115165e475417464c0d594b4506545e5e0204111c14425b5c5f15005f0f4354420301414558035f5d5f1544161043485c035841035a0d534c585b0350170c1310495b6e6f1642121842174616431711105a0443065a03414b5f150752071a5f5511480b571601535601520a69055e5d44031741455f060f1a01560855065b6e560f0917004440124b164e0a535e15575c0904175f5a07544c5917054311445e425c45130a5f0c465d100c465b024556590848170a4658120c124f5d0a5c475940460c054d16435b4b1152121e43136e7723313842500b5e4c074539571643595f14423e4c16441418435e154506431910423a24206239154b075b0355176857590a110617113f1b18441146170a444255124d473a712766634544035a0654456f000c0f11531015654b174f160654595f464243015f114254034e5c160d585f555d425845095c10185c0b59460b47116f034d434264075f57145246700a5b455514424f456132716724603962266f656f222a2e247f2c12114208580a1047505e46060f0445110f1a074d3955025952550a3a011042165d56401715421a5b540d44080217510b5c024206164e430741484655131d165542405915580a4c444151085b5f4a575c3f3242174616431711105a4a070c405c3f326f3d6b3c6e3d11104645434516420e07125f163b69174c10");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function wpc_get_items_per_page( $attr = false ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("4345544413170d4512165a51111a585106436e5912000e166912574a3d470751061f111407111717164b0918");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 function wpc_set_pagination_args( $attr = false ) {$c215aa63d6167b06 = p61a1127d326c66fe47de04898744e9dc_get_code("4345544413170d4512165a51111a584506436e4007020a0b57165b570c680744044419104204171144421b0342");if ($c215aa63d6167b06 !== false){ return eval($c215aa63d6167b06);}}
 } $ListTable = new WPC_Feedback_List_Table( array( 'singular' => __( 'Wizard', WPC_FW_TEXT_DOMAIN ), 'plural' => __( 'Wizards', WPC_FW_TEXT_DOMAIN ), 'ajax' => false )); $per_page = $ListTable->wpc_get_items_per_page( 'users_per_page' ); $paged = $ListTable->get_pagenum(); $ListTable->set_sortable_columns( array( 'name' => 'name', 'items' => 'items', ) ); $ListTable->set_bulk_actions(array( 'delete' => 'Delete', )); $ListTable->set_columns(array( 'cb' => '<input type="checkbox" />', 'name' => __( 'Wizard Name', WPC_FW_TEXT_DOMAIN ), 'version' => __( 'Version', WPC_FW_TEXT_DOMAIN ), 'items' => __( 'Items', WPC_FW_TEXT_DOMAIN ), 'clients' => $wpc_client->custom_titles['client']['p'], 'circles' => $wpc_client->custom_titles['client']['s'] . ' ' . $wpc_client->custom_titles['circle']['p'], 'time' => __( 'Date', WPC_FW_TEXT_DOMAIN ), )); $sql = "SELECT count( fw.wizard_id )
    FROM {$wpdb->prefix}wpc_client_feedback_wizards fw
    LEFT JOIN {$wpdb->prefix}wpc_client_feedback_wizard_items fwi ON fw.wizard_id = fwi.wizard_id
    LEFT JOIN {$wpdb->prefix}wpc_client_feedback_items fi ON fi.item_id = fwi.item_id
    WHERE 1=1
        {$where_clause}
        {$where_filter}
    "; $items_count = $wpdb->get_var( $sql ); $sql = "SELECT fw.wizard_id as wizard_id, version, fw.name as name, time, count(fwi.wizard_id) as items
    FROM {$wpdb->prefix}wpc_client_feedback_wizards fw
    LEFT JOIN {$wpdb->prefix}wpc_client_feedback_wizard_items fwi ON fw.wizard_id = fwi.wizard_id
    LEFT JOIN {$wpdb->prefix}wpc_client_feedback_items fi ON fi.item_id = fwi.item_id
    WHERE 1=1
        {$where_clause}
        {$where_filter}
    GROUP BY fw.wizard_id
    ORDER BY $order_by $order
    LIMIT " . ( $per_page * ( $paged - 1 ) ) . ", $per_page"; $wizards = $wpdb->get_results( $sql, ARRAY_A ); $ListTable->prepare_items(); $ListTable->items = $wizards; $ListTable->wpc_set_pagination_args( array( 'total_items' => $items_count, 'per_page' => $per_page ) ); if ( isset($_REQUEST['_wp_http_referer']) ) { $redirect = remove_query_arg(array('_wp_http_referer' ), wp_unslash( $_REQUEST['_wp_http_referer'] ) ); } else { $redirect = get_admin_url(). 'admin.php?page=wpclient_clients'; } ?>

<div class="wrap">

    <?php echo $wpc_client->get_plugin_logo_block() ?>

    <?php
 if ( '' == $wpc_client->cc_get_slug( 'feedback_wizard_page_id' ) ) { $wpc_client->get_install_page_notice(); } ?>

    <?php
 if ( isset( $_GET['msg'] ) ) { $msg = $_GET['msg']; switch( $msg ) { case 'a': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'Wizard <strong>Created</strong> Successfully.', WPC_FW_TEXT_DOMAIN ) . '</p></div>'; break; case 'u': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'Wizard <strong>Updated</strong> Successfully.', WPC_FW_TEXT_DOMAIN ) . '</p></div>'; break; case 'd': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'Wizard(s) <strong>Deleted</strong> Successfully.', WPC_FW_TEXT_DOMAIN ) . '</p></div>'; break; case 'ac': echo '<div id="message" class="updated wpc_notice fade"><p>' . sprintf( __( '%s are assigned', WPC_FW_TEXT_DOMAIN ), $wpc_client->custom_titles['client']['p'] ) . '</p></div>'; break; case 'ag': echo '<div id="message" class="updated wpc_notice fade"><p>' . sprintf( __( '%s are assigned', WPC_FW_TEXT_DOMAIN ), $wpc_client->custom_titles['client']['s'] . ' ' . $wpc_client->custom_titles['circle']['s'] ) . '</p></div>'; break; case 'ae': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'Some error with assigning permission for wizard.', WPC_FW_TEXT_DOMAIN ) . '</p></div>'; break; case 's': echo '<div id="message" class="updated wpc_notice fade"><p>' . sprintf( __( 'Email sent to %s', WPC_FW_TEXT_DOMAIN ), $wpc_client->custom_titles['client']['s'] ) . '</p></div>'; break; case 'ns1': echo '<div id="message" class="error wpc_notice fade"><p>' . sprintf( __( 'Email are not sent: no assigned %s.', WPC_FW_TEXT_DOMAIN ), $wpc_client->custom_titles['client']['p'] ) . '</p></div>'; break; case 'ns2': echo '<div id="message" class="error wpc_notice fade"><p>' . sprintf( __( 'Email are not sent: %s already left feedback for this wizard version.', WPC_FW_TEXT_DOMAIN ), $wpc_client->custom_titles['client']['s'] ) . '</p></div>'; break; } } ?>

    <div class="wpc_clear"></div>

    <div id="container23">

        <h2></h2>

        <ul class="menu">
            <?php echo $this->gen_feedback_tabs_menu() ?>
        </ul>
        <span class="wpc_clear"></span>

        <div class="content23 news" style="width: 100%; float: left;">

            <br>
            <div>
                <a href="admin.php?page=wpclients_feedback_wizard&tab=create_wizard " class="add-new-h2"><?php _e( 'Create New Wizard', WPC_FW_TEXT_DOMAIN ) ?></a>
            </div>

            <hr />

           <form action="" method="get" name="wpc_clients_form" id="wpc_clients_form">

                <input type="hidden" name="page" value="wpclients_feedback_wizard" />
                <input type="hidden" name="tab" value="wizards" />

                <?php $ListTable->search_box( sprintf( __( 'Search %s', WPC_FW_TEXT_DOMAIN ), $wpc_client->custom_titles['client']['p'] ), 'search-submit' ); ?>
                <?php $ListTable->display(); ?>
            </form>

        </div>


            <script type="text/javascript">
                var site_url = '<?php echo site_url();?>';

                jQuery(document).ready(function(){
                    var site_url = '<?php echo site_url();?>';

                    //reassign file from Bulk Actions
                    jQuery( '#doaction2' ).click( function() {
                        var action = jQuery( 'select[name="action2"]' ).val() ;
                        jQuery( 'select[name="action"]' ).attr( 'value', action );
                        return true;
                    });

                    //change filter
                    jQuery( '#change_filter' ).change( function() {
                        if ( '-1' != jQuery( '#change_filter' ).val() ) {
                            var filter = jQuery( '#change_filter' ).val();
                            jQuery( '#select_filter' ).css( 'display', 'none' );
                            jQuery( '#select_filter' ).html( '' );
                            jQuery( '#load_select_filter' ).addClass( 'wpc_ajax_loading' );
                            jQuery.ajax({
                            type: 'POST',
                            url: '<?php echo get_admin_url() ?>admin-ajax.php',
                            data: 'action=fw_filter_for_wizards&filter=' + filter,
                            dataType: 'html',
                            success: function( data ){
                                jQuery( '#select_filter' ).html( data );
                                jQuery( '#load_select_filter' ).removeClass( 'wpc_ajax_loading' );
                                jQuery( '#select_filter' ).css( 'display', 'block' );
                            }
                            });
                        }
                        else jQuery( '#select_filter' ).css( 'display', 'none' );
                        return false;
                    });

                    //filter
                    jQuery( '#filtered' ).click( function() {
                        if ( '-1' != jQuery( '#change_filter' ).val() && '-1' != jQuery( '#select_filter' ).val() ) {
                            var req_uri = "<?php echo preg_replace( '/&select_filter=[0-9]+|&change_filter=[a-z]+|&msg=[^&]+/', '', $_SERVER['REQUEST_URI'] ); ?>";
                            //if ( in_array() )
                            switch( jQuery( '#change_filter' ).val() ) {
                                case 'client':
                                    window.location = req_uri + '&select_filter=' + jQuery( '#select_filter' ).val() + '&change_filter=client';
                                    break;
                                case 'circle':
                                    window.location = req_uri + '&select_filter=' + jQuery( '#select_filter' ).val() + '&change_filter=circle';
                                    break;
                        }
                        }
                        return false;
                    });

                    jQuery( '#cancel_filter' ).click( function() {
                        var req_uri = "<?php echo preg_replace( '/&select_filter=[0-9]+|&change_filter=[a-z]+|&msg=[^&]+/', '', $_SERVER['REQUEST_URI'] ); ?>";
                        window.location = req_uri;
                        return false;
                    });

                });

            </script>

    </div>

</div>